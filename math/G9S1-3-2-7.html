<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‰è§’å½¢çš„é‡å¿ƒ - äº’å‹•è§£é¡Œå…¨é›†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* åŸºç¤è¨­å®š */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
            overflow-x: hidden;
        }

        /* æ•¸å­¸ç·šæ®µæ¨£å¼ (Overline for segments) */
        .segment {
            border-top: 2px solid #000;
            padding-top: 2px;
            display: inline-block;
            line-height: 1.2;
        }

        /* Slot å¡«ç­”æ ¼æ¨£å¼ */
        .slot {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            min-width: 50px;
            padding: 0 8px;
            height: 45px;
            border: 2px dashed #9ca3af;
            border-radius: 8px;
            background-color: #fff;
            margin: 0 4px;
            font-size: 1.25rem;
            font-weight: bold;
            color: #2563eb;
            cursor: pointer;
            transition: all 0.2s;
            vertical-align: middle;
        }
        
        .slot.filled {
            border: 2px solid #2563eb;
            background-color: #eff6ff;
        }

        .slot.correct {
            border: 2px solid #10b981; /* Green */
            background-color: #d1fae5;
            color: #047857;
        }
        
        /* éŒ¯èª¤æç¤ºæ¨£å¼ */
        .slot.incorrect {
            border: 2px solid #ef4444;
            background-color: #fee2e2;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* é¸é …æŒ‰éˆ•æ¨£å¼ */
        .option-btn {
            background-color: #fff;
            border: 2px solid #3b82f6;
            color: #3b82f6;
            padding: 8px 16px;
            border-radius: 999px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            user-select: none;
            margin-bottom: 8px;
        }

        .option-btn:hover:not(:disabled) {
            background-color: #3b82f6;
            color: #fff;
            transform: translateY(-2px);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .option-btn:disabled {
            background-color: #e5e7eb;
            border-color: #d1d5db;
            color: #9ca3af;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* å‹•ç•«æ•ˆæœ */
        @keyframes tada {
            0% { transform: scale(1); }
            10%, 20% { transform: scale(0.9) rotate(-3deg); }
            30%, 50%, 70%, 90% { transform: scale(1.1) rotate(3deg); }
            40%, 60%, 80% { transform: scale(1.1) rotate(-3deg); }
            100% { transform: scale(1) rotate(0); }
        }

        .animate-tada {
            animation: tada 1s ease-in-out;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æ­¥é©Ÿé–å®š */
        .step-container {
            display: none; /* é è¨­éš±è—ï¼Œé€é JS è§£é– */
            border-left: 4px solid #e5e7eb;
            padding-left: 20px;
            margin-bottom: 30px;
            position: relative;
        }

        .step-container.active {
            display: block;
            border-left-color: #3b82f6;
        }
        
        .step-container.completed {
            display: block;
            border-left-color: #10b981;
        }

        /* è‡ªè¨‚ Scrollbar (æ©«å‘å°è¦½åˆ—) */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* æ•¸å­¸åˆ†æ•¸æ¨£å¼ */
        .math { font-size: 20px; font-weight: 600; display: inline-flex; align-items: center; gap: 4px; }
        .fraction { display: inline-flex; flex-direction: column; align-items: center; line-height: 1.1; vertical-align: middle;}
        .fraction span:first-child { border-bottom: 2px solid #000; padding: 0 4px; }
    </style>
</head>
<body class="h-screen flex flex-col">

    <nav class="bg-white shadow-md z-50 flex-none">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center h-16 space-x-4 overflow-x-auto scrollbar-hide">
                <div class="flex-shrink-0 font-bold text-gray-700 mr-4">
                    ğŸ“ ä¸‰è§’å½¢çš„é‡å¿ƒ
                </div>
                <button onclick="switchProblem(1)" id="nav-btn-1" class="nav-btn px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-700 whitespace-nowrap">
                    1. é‡å¿ƒä½ç½®
                </button>
                <button onclick="switchProblem(2)" id="nav-btn-2" class="nav-btn px-4 py-2 rounded-lg text-sm font-medium text-gray-500 hover:text-gray-700 whitespace-nowrap">
                    2. é•·åº¦è¨ˆç®— (å…¥é–€)
                </button>
                <button onclick="switchProblem(3)" id="nav-btn-3" class="nav-btn px-4 py-2 rounded-lg text-sm font-medium text-gray-500 hover:text-gray-700 whitespace-nowrap">
                    3. æ¯”ä¾‹æ€§è³ª
                </button>
                <button onclick="switchProblem(4)" id="nav-btn-4" class="nav-btn px-4 py-2 rounded-lg text-sm font-medium text-gray-500 hover:text-gray-700 whitespace-nowrap">
                    4. é€²éšè¨ˆç®— (å¡«å…¬å¼)
                </button>
            </div>
        </div>
    </nav>

    <div class="flex-1 flex flex-col md:flex-row overflow-hidden relative">

        <div class="w-full md:w-1/3 bg-white border-r border-gray-200 overflow-y-auto p-6 md:h-full relative shadow-sm z-10">
            
            <div id="problem-area-1" class="problem-display">
                <h2 class="text-xl font-bold mb-4 text-gray-800">é‡å¿ƒåœ¨å“ªè£¡ï¼Ÿ</h2>
                <p class="mb-4 text-gray-600 leading-relaxed">
                    å¦‚åœ–ï¼Œå¦‚æœç”¨æ‰‹æŒ‡æ’èµ·ä¸‰è§’å½¢æ¿çš„é‡å¿ƒï¼Œå¯ç™¼ç¾ä¸‰è§’å½¢æ¿å‘ˆç¾å¹³è¡¡çš„ç‹€æ…‹ï¼Œä¸æœƒæ‰ä¸‹ä¾†ã€‚
                </p>
                <div class="bg-blue-50 p-4 rounded-xl flex justify-center items-center mb-4">
                     <svg width="200" height="150" viewBox="0 0 200 150">
                        <path d="M40,100 L160,100 L100,40 Z" fill="#ddd" stroke="#666" stroke-width="2"/>
                        <circle cx="100" cy="80" r="3" fill="#e63946"/>
                        <text x="105" y="80" font-size="12" fill="#e63946">é‡å¿ƒ</text>
                        <path d="M95,150 L95,100 L105,100 L105,150 Z" fill="#fca5a5"/>
                     </svg>
                </div>
            </div>

            <div id="problem-area-2" class="problem-display hidden">
                <h2 class="text-xl font-bold mb-4 text-gray-800">è¨ˆç®—é•·åº¦ (å…¥é–€)</h2>
                <p class="mb-2 text-gray-600">
                    <span class="font-bold">å·²çŸ¥ä¸­ç·šé•·åº¦ï¼š</span><br>
                    1. <span class="segment">AD</span> = <mark class="bg-yellow-200 px-1 rounded">6</mark><br>
                    2. <span class="segment">BE</span> = <mark class="bg-blue-200 px-1 rounded">12</mark><br>
                    3. <span class="segment">CF</span> = <mark class="bg-green-200 px-1 rounded">9</mark>
                </p>
                <div class="bg-white p-2 rounded-xl flex justify-center items-center">
                    <svg width="220" height="180" viewBox="0 0 220 180">
                        <polygon points="110,20 20,150 200,150" fill="none" stroke="#333" stroke-width="2"/>
                        <text x="105" y="15" font-size="16" font-weight="bold">A</text>
                        <text x="5" y="160" font-size="16" font-weight="bold">B</text>
                        <text x="205" y="160" font-size="16" font-weight="bold">C</text>
                        <line x1="110" y1="20" x2="110" y2="150" stroke="#f59e0b" stroke-width="2" /> 
                        <text x="105" y="170" font-size="14">D</text>
                        <line x1="20" y1="150" x2="155" y2="85" stroke="#3b82f6" stroke-width="2" />
                        <text x="160" y="85" font-size="14">E</text>
                        <line x1="200" y1="150" x2="65" y2="85" stroke="#10b981" stroke-width="2" />
                        <text x="50" y="85" font-size="14">F</text>
                        <circle cx="110" cy="106.6" r="4" fill="#000"/>
                        <text x="115" y="115" font-size="16" font-weight="bold">G</text>
                    </svg>
                </div>
            </div>

            <div id="problem-area-3" class="problem-display hidden">
                <h2 class="text-xl font-bold mb-4 text-gray-800">é‡å¿ƒèˆ‡ä¸­ç·šçš„æ¯”ä¾‹</h2>
                <p class="mb-4 text-gray-600">
                    å¦‚åœ–ï¼Œ<span class="segment">AD</span>ã€<span class="segment">BE</span>ã€<span class="segment">CF</span> ç‚ºä¸­ç·šï¼Œäº¤æ–¼ <span class="font-bold">G</span> é»ï¼ˆé‡å¿ƒï¼‰ã€‚
                </p>
                <div class="bg-white p-2 rounded-xl flex justify-center items-center">
                   <svg width="220" height="180" viewBox="0 0 220 180">
                        <polygon points="110,20 20,150 200,150" fill="none" stroke="#333" stroke-width="2"/>
                        <text x="105" y="15" font-size="16" font-weight="bold">A</text>
                        <text x="5" y="160" font-size="16" font-weight="bold">B</text>
                        <text x="205" y="160" font-size="16" font-weight="bold">C</text>
                        <line x1="110" y1="20" x2="110" y2="150" stroke="#999" stroke-width="1.5" /> 
                        <line x1="20" y1="150" x2="155" y2="85" stroke="#999" stroke-width="1.5" />
                        <line x1="200" y1="150" x2="65" y2="85" stroke="#999" stroke-width="1.5" />
                        <circle cx="110" cy="106.6" r="4" fill="#000"/>
                        <text x="115" y="120" font-size="16" font-weight="bold">G</text>
                        <text x="105" y="170" font-size="14">D</text>
                        <text x="160" y="85" font-size="14">E</text>
                        <text x="50" y="85" font-size="14">F</text>
                    </svg>
                </div>
            </div>

            <div id="problem-area-4" class="problem-display hidden">
                <h2 class="text-xl font-bold mb-4 text-gray-800">é€²éšè¨ˆç®— (å¡«å…¥å…¬å¼)</h2>
                <p class="mb-2 text-gray-600">
                    <span class="font-bold">å·²çŸ¥ï¼š</span><br>
                    1. ä¸­ç·š <span class="segment">AD</span> = <mark class="bg-yellow-100 px-1 rounded">9</mark><br>
                    2. ä¸­ç·š <span class="segment">BE</span> = <mark class="bg-blue-100 px-1 rounded">12</mark><br>
                    3. ä¸­ç·š <span class="segment">CF</span> = <mark class="bg-green-100 px-1 rounded">15</mark>
                </p>
                <div class="bg-white p-2 rounded-xl flex justify-center items-center border-2 border-dashed border-gray-300">
                    <svg width="220" height="180" viewBox="0 0 220 180">
                        <polygon points="110,20 20,150 200,150" fill="none" stroke="#333" stroke-width="2"/>
                        <text x="105" y="15" font-size="16" font-weight="bold">A</text>
                        <text x="5" y="160" font-size="16" font-weight="bold">B</text>
                        <text x="205" y="160" font-size="16" font-weight="bold">C</text>
                        <line x1="110" y1="20" x2="110" y2="150" stroke="#f59e0b" stroke-width="2" />
                        <line x1="20" y1="150" x2="155" y2="85" stroke="#3b82f6" stroke-width="2" />
                        <line x1="200" y1="150" x2="65" y2="85" stroke="#10b981" stroke-width="2" />
                        <circle cx="110" cy="106.6" r="4" fill="#000"/>
                        <text x="120" y="110" font-size="16" font-weight="bold">G</text>
                        <text x="105" y="170" font-size="14">D</text>
                        <text x="160" y="85" font-size="14">E</text>
                        <text x="50" y="85" font-size="14">F</text>
                    </svg>
                </div>
                <div class="mt-4 p-3 bg-indigo-50 text-indigo-800 text-sm rounded-lg">
                    <span class="font-bold">æç¤ºï¼š</span>ä½ éœ€è¦è‡ªå·±å¡«å…¥ã€Œé™¤ä»¥å¹¾ã€å’Œã€Œä¹˜ä»¥å¹¾ã€ã€‚
                </div>
            </div>

        </div>

        <div class="w-full md:w-2/3 bg-gray-50 overflow-y-auto p-6 relative" id="steps-scroll-area">
            
            <div id="steps-area-1" class="max-w-2xl mx-auto pb-20">
                <div class="step-container active fade-in" id="p1-step1">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">1. ç›´è§’ä¸‰è§’å½¢çš„é‡å¿ƒåœ¨å“ªè£¡ï¼Ÿ</h3>
                    <div class="flex flex-wrap gap-2 mb-4 items-center">
                        <span class="text-lg">ç›´è§’ä¸‰è§’å½¢çš„é‡å¿ƒåœ¨</span>
                        <div class="slot" data-answer="å…§éƒ¨" onclick="clearSlot(this)"></div>
                        <span class="text-lg">ã€‚</span>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('å¤–éƒ¨', this)">å¤–éƒ¨</button>
                        <button class="option-btn" onclick="selectOption('å…§éƒ¨', this)">å…§éƒ¨</button>
                        <button class="option-btn" onclick="selectOption('ä»»ä¸€é‚Šä¸Š', this)">ä»»ä¸€é‚Šä¸Š</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p1-step1', 'p1-step2')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>

                <div class="step-container fade-in" id="p1-step2">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">2. éˆè§’ä¸‰è§’å½¢çš„é‡å¿ƒåœ¨å“ªè£¡ï¼Ÿ</h3>
                    <div class="flex flex-wrap gap-2 mb-4 items-center">
                        <span class="text-lg">éˆè§’ä¸‰è§’å½¢çš„é‡å¿ƒåœ¨</span>
                        <div class="slot" data-answer="å…§éƒ¨" onclick="clearSlot(this)"></div>
                        <span class="text-lg">ã€‚</span>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('å¤–éƒ¨', this)">å¤–éƒ¨</button>
                        <button class="option-btn" onclick="selectOption('å…§éƒ¨', this)">å…§éƒ¨</button>
                        <button class="option-btn" onclick="selectOption('ä»»ä¸€é‚Šä¸Š', this)">ä»»ä¸€é‚Šä¸Š</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p1-step2', 'p1-step3')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>

                <div class="step-container fade-in" id="p1-step3">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">3. éŠ³è§’ä¸‰è§’å½¢çš„é‡å¿ƒåœ¨å“ªè£¡ï¼Ÿ</h3>
                    <div class="flex flex-wrap gap-2 mb-4 items-center">
                        <span class="text-lg">éŠ³è§’ä¸‰è§’å½¢çš„é‡å¿ƒåœ¨</span>
                        <div class="slot" data-answer="å…§éƒ¨" onclick="clearSlot(this)"></div>
                        <span class="text-lg">ã€‚</span>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('å¤–éƒ¨', this)">å¤–éƒ¨</button>
                        <button class="option-btn" onclick="selectOption('å…§éƒ¨', this)">å…§éƒ¨</button>
                        <button class="option-btn" onclick="selectOption('ä»»ä¸€é‚Šä¸Š', this)">ä»»ä¸€é‚Šä¸Š</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p1-step3', 'finish')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
            </div>

            <div id="steps-area-2" class="max-w-2xl mx-auto hidden pb-20">
                <div class="step-container active fade-in" id="p2-step1">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">1. æ±‚ AG çš„é•·åº¦</h3>
                    <div class="flex flex-wrap gap-2 mb-4 items-center bg-white p-4 rounded-lg shadow-sm">
                        <span class="text-2xl text-gray-400">(</span>
                        <div class="slot" data-answer="6" onclick="clearSlot(this)"></div>
                        <span class="text-2xl text-gray-400">)</span>
                        <span class="text-xl">Ã· 3 Ã— 2 =</span>
                        <span class="text-2xl text-gray-400">(</span>
                        <div class="slot" data-answer="4" onclick="clearSlot(this)"></div>
                        <span class="text-2xl text-gray-400">)</span>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('6', this)">6</button>
                        <button class="option-btn" onclick="selectOption('4', this)">4</button>
                        <button class="option-btn" onclick="selectOption('3', this)">3</button>
                        <button class="option-btn" onclick="selectOption('12', this)">12</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p2-step1', 'p2-step2')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
                <div class="step-container fade-in" id="p2-step2">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">2. æ±‚ BG çš„é•·åº¦</h3>
                    <div class="flex flex-wrap gap-2 mb-4 items-center bg-white p-4 rounded-lg shadow-sm">
                        <span class="text-2xl text-gray-400">(</span>
                        <div class="slot" data-answer="12" onclick="clearSlot(this)"></div>
                        <span class="text-2xl text-gray-400">)</span>
                        <span class="text-xl">Ã· 3 Ã— 2 =</span>
                        <span class="text-2xl text-gray-400">(</span>
                        <div class="slot" data-answer="8" onclick="clearSlot(this)"></div>
                        <span class="text-2xl text-gray-400">)</span>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('12', this)">12</button>
                        <button class="option-btn" onclick="selectOption('8', this)">8</button>
                        <button class="option-btn" onclick="selectOption('4', this)">4</button>
                        <button class="option-btn" onclick="selectOption('24', this)">24</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p2-step2', 'p2-step3')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
                <div class="step-container fade-in" id="p2-step3">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">3. æ±‚ CG çš„é•·åº¦</h3>
                    <div class="flex flex-wrap gap-2 mb-4 items-center bg-white p-4 rounded-lg shadow-sm">
                        <span class="text-2xl text-gray-400">(</span>
                        <div class="slot" data-answer="9" onclick="clearSlot(this)"></div>
                        <span class="text-2xl text-gray-400">)</span>
                        <span class="text-xl">Ã· 3 Ã— 2 =</span>
                        <span class="text-2xl text-gray-400">(</span>
                        <div class="slot" data-answer="6" onclick="clearSlot(this)"></div>
                        <span class="text-2xl text-gray-400">)</span>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('9', this)">9</button>
                        <button class="option-btn" onclick="selectOption('6', this)">6</button>
                        <button class="option-btn" onclick="selectOption('3', this)">3</button>
                        <button class="option-btn" onclick="selectOption('18', this)">18</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p2-step3', 'finish')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
            </div>

            <div id="steps-area-3" class="max-w-2xl mx-auto hidden pb-20">
                <div class="step-container active fade-in" id="p3-step1">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">1. é‡å¿ƒåˆ°é ‚é» : é‡å¿ƒåˆ°å°é‚Šä¸­é»</h3>
                    <p class="text-gray-600 mb-2">æ±‚ <span class="segment">AG</span> : <span class="segment">GD</span></p>
                    <div class="flex flex-wrap gap-2 mb-4 items-center">
                        <div class="slot" data-answer="2" onclick="clearSlot(this)"></div>
                        <span class="text-xl mx-1">:</span>
                        <div class="slot" data-answer="1" onclick="clearSlot(this)"></div>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('1', this)">1</button>
                        <button class="option-btn" onclick="selectOption('2', this)">2</button>
                        <button class="option-btn" onclick="selectOption('3', this)">3</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p3-step1', 'p3-step2')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
                <div class="step-container fade-in" id="p3-step2">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">2. åŒæ¨£çš„æ¯”ä¾‹é—œä¿‚</h3>
                    <p class="text-gray-600 mb-2">æ±‚ <span class="segment">BG</span> : <span class="segment">GE</span></p>
                    <div class="flex flex-wrap gap-2 mb-4 items-center">
                        <div class="slot" data-answer="2" onclick="clearSlot(this)"></div>
                        <span class="text-xl mx-1">:</span>
                        <div class="slot" data-answer="1" onclick="clearSlot(this)"></div>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('1', this)">1</button>
                        <button class="option-btn" onclick="selectOption('2', this)">2</button>
                        <button class="option-btn" onclick="selectOption('3', this)">3</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p3-step2', 'p3-step3')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
                <div class="step-container fade-in" id="p3-step3">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">3. é‡å¿ƒæ®µ : æ•´æ¢ä¸­ç·š</h3>
                    <p class="text-gray-600 mb-2">æ±‚ <span class="segment">CG</span> : <span class="segment">CF</span></p>
                    <div class="flex flex-wrap gap-2 mb-4 items-center">
                        <div class="slot" data-answer="2" onclick="clearSlot(this)"></div>
                        <span class="text-xl mx-1">:</span>
                        <div class="slot" data-answer="3" onclick="clearSlot(this)"></div>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('1', this)">1</button>
                        <button class="option-btn" onclick="selectOption('2', this)">2</button>
                        <button class="option-btn" onclick="selectOption('3', this)">3</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p3-step3', 'finish')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
            </div>

            <div id="steps-area-4" class="max-w-2xl mx-auto hidden pb-20">
                <div class="step-container active fade-in" id="p4-step1">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">1. æ±‚ <span class="segment">AG</span> (å·²çŸ¥ AD=9)</h3>
                    <div class="flex flex-wrap gap-2 mb-4 items-center bg-white p-4 rounded-lg shadow-sm">
                        <div class="slot" data-answer="9" onclick="clearSlot(this)"></div>
                        <span class="text-xl">Ã·</span>
                        <div class="slot" data-answer="3" onclick="clearSlot(this)"></div>
                        <span class="text-xl">Ã—</span>
                        <div class="slot" data-answer="2" onclick="clearSlot(this)"></div>
                        <span class="text-xl">=</span>
                        <div class="slot" data-answer="6" onclick="clearSlot(this)"></div>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('9', this)">9</button>
                        <button class="option-btn" onclick="selectOption('3', this)">3</button>
                        <button class="option-btn" onclick="selectOption('2', this)">2</button>
                        <button class="option-btn" onclick="selectOption('6', this)">6</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p4-step1', 'p4-step2')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>

                <div class="step-container fade-in" id="p4-step2">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">2. æ±‚ <span class="segment">BG</span> (å·²çŸ¥ BE=12)</h3>
                    <div class="flex flex-wrap gap-2 mb-4 items-center bg-white p-4 rounded-lg shadow-sm">
                        <div class="slot" data-answer="12" onclick="clearSlot(this)"></div>
                        <span class="text-xl">Ã·</span>
                        <div class="slot" data-answer="3" onclick="clearSlot(this)"></div>
                        <span class="text-xl">Ã—</span>
                        <div class="slot" data-answer="2" onclick="clearSlot(this)"></div>
                        <span class="text-xl">=</span>
                        <div class="slot" data-answer="8" onclick="clearSlot(this)"></div>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('12', this)">12</button>
                        <button class="option-btn" onclick="selectOption('3', this)">3</button>
                        <button class="option-btn" onclick="selectOption('2', this)">2</button>
                        <button class="option-btn" onclick="selectOption('8', this)">8</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p4-step2', 'p4-step3')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>

                <div class="step-container fade-in" id="p4-step3">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">3. æ±‚ <span class="segment">CG</span> (å·²çŸ¥ CF=15)</h3>
                    <div class="flex flex-wrap gap-2 mb-4 items-center bg-white p-4 rounded-lg shadow-sm">
                        <div class="slot" data-answer="15" onclick="clearSlot(this)"></div>
                        <span class="text-xl">Ã·</span>
                        <div class="slot" data-answer="3" onclick="clearSlot(this)"></div>
                        <span class="text-xl">Ã—</span>
                        <div class="slot" data-answer="2" onclick="clearSlot(this)"></div>
                        <span class="text-xl">=</span>
                        <div class="slot" data-answer="10" onclick="clearSlot(this)"></div>
                    </div>
                    <div class="options-area flex gap-3 flex-wrap">
                        <button class="option-btn" onclick="selectOption('15', this)">15</button>
                        <button class="option-btn" onclick="selectOption('3', this)">3</button>
                        <button class="option-btn" onclick="selectOption('2', this)">2</button>
                        <button class="option-btn" onclick="selectOption('10', this)">10</button>
                    </div>
                    <button class="check-btn mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all hidden" onclick="checkStep('p4-step3', 'finish')">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
            </div>

            <div id="completion-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                <div class="bg-white rounded-2xl p-8 max-w-sm w-full mx-4 text-center shadow-2xl animate-tada">
                    <div class="text-6xl mb-4">ğŸ‰</div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">å¤ªæ£’äº†ï¼</h2>
                    <p class="text-gray-600 mb-6">ä½ å·²ç¶“å®Œæˆæœ¬é¡Œçš„æ‰€æœ‰ç·´ç¿’ã€‚</p>
                    <div class="flex flex-col gap-3">
                        <button onclick="resetCurrentProblem()" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 rounded-xl transition-colors">
                            å†åšä¸€æ¬¡
                        </button>
                        <button onclick="closeModal()" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-3 rounded-xl transition-colors">
                            é—œé–‰è¦–çª—
                        </button>
                    </div>
                </div>
            </div>

            <div id="error-toast" class="fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 rounded shadow-lg transition-all duration-300 opacity-0 translate-y-10 z-50">
                <p class="font-bold">å†æƒ³æƒ³çœ‹ ğŸ’ª</p>
                <p class="text-sm">æœ‰äº›ç©ºæ ¼å¡«éŒ¯å›‰ï¼ŒåŠ æ²¹ï¼</p>
            </div>

        </div>
    </div>

    <script>
        let currentProblemId = 1;

        document.addEventListener('DOMContentLoaded', () => {
            switchProblem(1);
        });

        // åˆ‡æ›é¡Œç›®
        function switchProblem(id) {
            currentProblemId = id;
            
            // Nav æ¨£å¼æ›´æ–°
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-blue-100', 'text-blue-700');
                btn.classList.add('text-gray-500');
            });
            const activeBtn = document.getElementById(`nav-btn-${id}`);
            activeBtn.classList.add('bg-blue-100', 'text-blue-700');
            activeBtn.classList.remove('text-gray-500');

            // é¡¯ç¤ºå°æ‡‰å€åŸŸ
            document.querySelectorAll('.problem-display').forEach(el => el.classList.add('hidden'));
            document.getElementById(`problem-area-${id}`).classList.remove('hidden');

            document.querySelectorAll('[id^="steps-area-"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(`steps-area-${id}`).classList.remove('hidden');

            // æ²å‹•å›é ‚éƒ¨
            document.getElementById('steps-scroll-area').scrollTop = 0;
        }

        // é¸æ“‡é¸é …å¡«å…¥
        function selectOption(value, btn) {
            const currentStep = btn.closest('.step-container');
            const slots = currentStep.querySelectorAll('.slot:not(.filled)');
            
            if (slots.length > 0) {
                const targetSlot = slots[0];
                targetSlot.textContent = value;
                targetSlot.classList.add('filled');
                
                // ç¦ç”¨æŒ‰éˆ•
                btn.disabled = true;

                // æª¢æŸ¥æ˜¯å¦æ‰€æœ‰æ ¼éƒ½å¡«æ»¿
                const remainingSlots = currentStep.querySelectorAll('.slot:not(.filled)');
                const checkBtn = currentStep.querySelector('.check-btn');
                
                if (remainingSlots.length === 0 && checkBtn) {
                    checkBtn.classList.remove('hidden');
                    checkBtn.classList.add('animate-tada');
                    checkBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        }

        // æ¸…é™¤æ ¼å…§å®¹
        function clearSlot(slot) {
            if (!slot.classList.contains('filled')) return;
            
            const stepContainer = slot.closest('.step-container');
            if (stepContainer.classList.contains('completed')) return; // å·²å®Œæˆé–å®š

            const value = slot.textContent;
            slot.textContent = '';
            slot.classList.remove('filled', 'correct', 'incorrect');
            
            // æ¢å¾©æŒ‰éˆ•
            const optionsArea = stepContainer.querySelector('.options-area');
            const buttons = Array.from(optionsArea.querySelectorAll('.option-btn'));
            const btnToEnable = buttons.find(b => b.textContent === value && b.disabled);
            if (btnToEnable) {
                btnToEnable.disabled = false;
            }

            // éš±è—æª¢æŸ¥æŒ‰éˆ•
            const checkBtn = stepContainer.querySelector('.check-btn');
            if (checkBtn) {
                checkBtn.classList.add('hidden');
            }
        }

        // æª¢æŸ¥ç­”æ¡ˆ
        function checkStep(currentStepId, nextStepId) {
            const stepElement = document.getElementById(currentStepId);
            const slots = stepElement.querySelectorAll('.slot');
            let allCorrect = true;

            slots.forEach(slot => {
                if (slot.textContent.trim() !== slot.dataset.answer) {
                    allCorrect = false;
                    slot.classList.add('incorrect');
                    setTimeout(() => slot.classList.remove('incorrect'), 1500);
                } else {
                    slot.classList.remove('incorrect');
                    slot.classList.add('correct');
                }
            });

            if (allCorrect) {
                stepElement.classList.add('completed');
                
                // éš±è—æª¢æŸ¥æŒ‰éˆ•
                const checkBtn = stepElement.querySelector('.check-btn');
                checkBtn.style.display = 'none';

                // æ¨™ç¤ºå®Œæˆ
                const title = stepElement.querySelector('h3');
                if (!title.querySelector('.check-mark')) {
                    const checkMark = document.createElement('span');
                    checkMark.className = 'text-green-500 ml-2 check-mark';
                    checkMark.innerHTML = 'âœ” å®Œæˆ';
                    title.appendChild(checkMark);
                }

                // éš±è—é¸é …å€
                stepElement.querySelector('.options-area').style.display = 'none';

                if (nextStepId === 'finish') {
                    showCompletionModal();
                } else {
                    const nextStep = document.getElementById(nextStepId);
                    nextStep.classList.add('active');
                    setTimeout(() => {
                        nextStep.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 100);
                }
            } else {
                showErrorToast();
            }
        }

        function showErrorToast() {
            const toast = document.getElementById('error-toast');
            toast.classList.remove('opacity-0', 'translate-y-10');
            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-10');
            }, 2500);
        }

        function showCompletionModal() {
            document.getElementById('completion-modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('completion-modal').classList.add('hidden');
        }

        function resetCurrentProblem() {
            closeModal();
            const stepArea = document.getElementById(`steps-area-${currentProblemId}`);
            
            stepArea.querySelectorAll('.step-container').forEach((step, index) => {
                step.classList.remove('completed', 'active');
                if (index === 0) step.classList.add('active');

                const checkMark = step.querySelector('.check-mark');
                if (checkMark) checkMark.remove();

                const optionsDiv = step.querySelector('.options-area');
                optionsDiv.style.display = 'flex'; // æ¢å¾©é¡¯ç¤ºé¸é …

                const checkBtn = step.querySelector('.check-btn');
                checkBtn.classList.add('hidden');
                checkBtn.style.display = ''; 
            });

            stepArea.querySelectorAll('.slot').forEach(slot => {
                slot.textContent = '';
                slot.className = 'slot';
            });

            stepArea.querySelectorAll('.option-btn').forEach(btn => {
                btn.disabled = false;
            });

            document.getElementById('steps-scroll-area').scrollTop = 0;
        }
    </script>
</body>
</html>