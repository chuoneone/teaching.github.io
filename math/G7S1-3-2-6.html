<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>互動學習單：一元一次方程式</title>
    <!-- 即使沒有圖檔，保留這行也不會報錯，或者你可以換成自己的 logo -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>✏️</text></svg>">
    
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 引入 KaTeX 數學公式 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" xintegrity="sha384-nB0mCrOMXqGshaCNdrA1YFsuVLRodGohlrmREQN/sRCJMFinN+EL1FNTL9PKSJ63" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" xintegrity="sha384-7/YYLCCoTddN+BTiLuK+qGfS6rXl1Pii1FkL4S/pRFH5LPC2S8rwdvF/dLT9VlqH" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" xintegrity="sha384-43gviWU0YVjaDtb/Gf1ESgOG+IPtSEAU+NwG5hSXT4ZabKmnreqN1Q+EAU0VLl6/+" crossorigin="anonymous"></script>
    
    <!-- 引入 Chiron GoRound TC 字型 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chiron+GoRound+TC:wght@200..900&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: "Chiron GoRound TC", sans-serif;
            font-weight: 400;
            font-style: normal;
            background-color: #f8fafc;
        }
        
        .highlight {
            background: linear-gradient(to top, #fef08a 50%, transparent 50%);
            padding: 0 0.2rem;
            border-radius: 3px;
        }

        .step-container {
            background-color: white;
            border-radius: 0.75rem;
            border: 1px solid #e2e8f0;
            padding: 1.5rem;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            /* 加上動畫，讓步驟出現更流暢 */
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 隱藏的步驟 */
        .step-hidden {
            display: none;
        }
        
        /* 導覽列按鈕 */
        .nav-btn {
            padding: 0.5rem 1rem;
            font-weight: 600;
            border-radius: 0.5rem;
            background-color: #e2e8f0;
            color: #475569;
            transition: all 0.2s;
            cursor: pointer;
        }
        .nav-btn:hover {
            background-color: #cbd5e1;
        }
        /* 導覽列啟用中按鈕 */
        .nav-btn-active {
            background-color: #3b82f6;
            color: white;
        }
        .nav-btn-active:hover {
            background-color: #2563eb;
        }

        /* 下一步按鈕 */
        .next-btn {
            background-color: #3b82f6; /* 藍色 */
            color: white;
            font-weight: 600;
            padding: 0.6rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
            border: none;
            cursor: pointer;
        }
        .next-btn:hover {
            background-color: #2563eb;
        }
        .next-btn:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        /* 最終按鈕 */
        .finish-btn { 
            background-color: #10b981; /* 綠色 */
        }
        .finish-btn:hover { 
            background-color: #059669;
        }
        
        .katex-display-area {
            font-size: 2.25rem; 
            color: #1e293b;
            padding: 1.5rem;
            background-color: #f1f5f9;
            border-radius: 0.5rem;
            text-align: center;
            margin-bottom: 1rem;
            overflow-x: auto;
        }
        
        .step-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }
        
        .step-progress {
            font-size: 0.9rem;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 1rem;
        }
        
        .step-instruction {
            color: #334155;
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }
        
        .solution-text {
            font-size: 1.5rem;
            color: #1e293b;
            text-align: center;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body class="min-h-screen pb-24">

    <div class="max-w-3xl mx-auto p-4 md:p-8">
        
        <!-- 導覽列 -->
        <nav class="flex justify-center flex-wrap gap-2 mb-8" id="nav-container">
            <button class="nav-btn nav-btn-active" data-question-index="0">第 1 題</button>
            <button class="nav-btn" data-question-index="1">第 2 題</button>
            <button class="nav-btn" data-question-index="2">第 3 題</button>
            <button class="nav-btn" data-question-index="3">第 4 題</button>
        </nav>

        <header class="text-center my-8">
            <h1 class="text-4xl font-bold text-slate-800">一元一次方程式</h1>
            <p class="text-lg text-slate-500 mt-2">解下列方程式，求出 x 的值</p>
        </header>

        <!-- 題目顯示區 (動態載入) -->
        <div class="katex-display-area" id="problem-area">
            <!-- JS will fill this -->
        </div>

        <!-- 逐步解題容器 (動態載入) -->
        <div class="space-y-6" id="steps-container">
            <!-- JS will fill this -->
        </div>
            
        <!-- 完成訊息 -->
        <div id="completion-message" class="text-center mt-8 p-6 bg-green-100 border-2 border-green-400 rounded-lg step-hidden">
            <h2 class="text-3xl font-bold text-green-700">太棒了！</h2>
            <p class="mt-2 text-green-600 text-lg">你已經成功解出這題方程式了！</p>
            <button id="reset-btn" class="mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg transition-colors text-lg">
                再看一次
            </button>
        </div>

    </div> <!-- end max-w-3xl -->

    <!-- 頁尾 -->
    <footer class="fixed bottom-0 left-0 w-full text-center text-gray-400 text-sm bg-white bg-opacity-80 py-2 border-t border-gray-200 backdrop-blur-sm">
      特教米克師｜互動學習單樣板
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 題目資料庫 ---
            const questions = [
                { 
                    // 第 1 題
                    problemKatex: "$$9x - (5x - 4) = 16$$",
                    steps: [
                        {
                            title: "步驟一：去括號",
                            instruction: "首先處理括號。注意括號前面是<span class='highlight'>負號</span>。<br>去括號時，括號內的每一項都要<span class='highlight'>變號</span>。",
                            katexDisplay: "$$9x - 5x + 4 = 16$$", 
                        },
                        {
                            title: "步驟二：合併同類項",
                            instruction: "接著，將含有 $x$ 的項合併在一起。<br>計算 $9x - 5x$：",
                            katexDisplay: "$$4x + 4 = 16$$",
                        },
                        {
                            title: "步驟三：移項法則",
                            instruction: "我們要把左邊的 $+4$ 移到等號右邊。<br>正的移過去變成<span class='highlight'>負的</span>。",
                            katexDisplay: "$$4x = 16 - 4$$",
                        },
                        {
                            title: "步驟四：計算常數",
                            instruction: "計算等號右邊的數值 $16 - 4$：",
                            katexDisplay: "$$4x = 12$$",
                        },
                        {
                            title: "步驟五：求解 x",
                            instruction: "最後，將 $x$ 前面的係數 $4$ 除過去。<br>等號兩邊同時除以 $4$：",
                            katexDisplay: "$$x = \\frac{12}{4} = 3$$",
                        },
                        {
                            title: "最終答案",
                            instruction: "所以，這題方程式的解為：",
                            katexDisplay: "$$x = 3$$",
                        }
                    ]
                },
                { 
                    // 第 2 題：(7x+11) - (3x+5) = 42
                    problemKatex: "$$(7x + 11) - (3x + 5) = 42$$",
                    steps: [
                        {
                            title: "步驟一：去括號",
                            instruction: "前面的括號直接去掉；後面的括號前面有<span class='highlight'>負號</span>，裡面的每一項都要<span class='highlight'>變號</span>。",
                            katexDisplay: "$$7x + 11 - 3x - 5 = 42$$", 
                        },
                        {
                            title: "步驟二：合併同類項",
                            instruction: "整理左邊的式子：<br>x 項合併：$7x - 3x = 4x$<br>常數項合併：$11 - 5 = 6$",
                            katexDisplay: "$$4x + 6 = 42$$",
                        },
                        {
                            title: "步驟三：移項法則",
                            instruction: "把左邊的 $+6$ 移到等號右邊。<br>正的移過去變成<span class='highlight'>負的</span>。",
                            katexDisplay: "$$4x = 42 - 6$$",
                        },
                        {
                            title: "步驟四：計算常數",
                            instruction: "計算等號右邊的數值 $42 - 6$：",
                            katexDisplay: "$$4x = 36$$",
                        },
                        {
                            title: "步驟五：求解 x",
                            instruction: "最後，等號兩邊同時除以 $4$：",
                            katexDisplay: "$$x = \\frac{36}{4} = 9$$",
                        },
                        {
                            title: "最終答案",
                            instruction: "所以，這題方程式的解為：",
                            katexDisplay: "$$x = 9$$",
                        }
                    ]
                },
                { 
                    // 第 3 題：4(3x+2) = 68
                    problemKatex: "$$4(3x + 2) = 68$$",
                    steps: [
                        {
                            title: "步驟一：利用分配律去括號",
                            instruction: "將括號外的 $4$ 分別乘進括號內的每一項。<br>$4 \\times 3x = 12x$，$4 \\times 2 = 8$。",
                            katexDisplay: "$$12x + 8 = 68$$", 
                        },
                        {
                            title: "步驟二：移項法則",
                            instruction: "把左邊的 $+8$ 移到等號右邊。<br>正的移過去變成<span class='highlight'>負的</span>。",
                            katexDisplay: "$$12x = 68 - 8$$",
                        },
                        {
                            title: "步驟三：計算常數",
                            instruction: "計算等號右邊的數值 $68 - 8$：",
                            katexDisplay: "$$12x = 60$$",
                        },
                        {
                            title: "步驟四：求解 x",
                            instruction: "最後，等號兩邊同時除以 $12$：",
                            katexDisplay: "$$x = \\frac{60}{12} = 5$$",
                        },
                        {
                            title: "最終答案",
                            instruction: "所以，這題方程式的解為：",
                            katexDisplay: "$$x = 5$$",
                        }
                    ]
                },
                { 
                    // 第 4 題：16 - 3(x+1) = 25
                    problemKatex: "$$16 - 3(x + 1) = 25$$",
                    steps: [
                        {
                            title: "步驟一：利用分配律去括號",
                            instruction: "注意括號前面是 $-3$，要把 $-3$ 乘進去。<br>$-3 \\times x = -3x$，$-3 \\times 1 = -3$。",
                            katexDisplay: "$$16 - 3x - 3 = 25$$", 
                        },
                        {
                            title: "步驟二：合併左邊常數",
                            instruction: "先把左邊的數字整理一下：<br>$16 - 3 = 13$。",
                            katexDisplay: "$$13 - 3x = 25$$",
                        },
                        {
                            title: "步驟三：移項法則",
                            instruction: "把左邊的 $13$ 移到等號右邊。<br>正的移過去變成<span class='highlight'>負的</span>。",
                            katexDisplay: "$$-3x = 25 - 13$$",
                        },
                        {
                            title: "步驟四：計算常數",
                            instruction: "計算等號右邊的數值 $25 - 13$：",
                            katexDisplay: "$$-3x = 12$$",
                        },
                        {
                            title: "步驟五：求解 x",
                            instruction: "等號兩邊同時除以 $-3$。<br>注意：正數除以負數，結果為<span class='highlight'>負數</span>。",
                            katexDisplay: "$$x = \\frac{12}{-3} = -4$$",
                        },
                        {
                            title: "最終答案",
                            instruction: "所以，這題方程式的解為：",
                            katexDisplay: "$$x = -4$$",
                        }
                    ]
                }
            ];

            // --- 獲取元素 ---
            const navContainer = document.getElementById('nav-container');
            const problemArea = document.getElementById('problem-area');
            const stepsContainer = document.getElementById('steps-container');
            const completionMessage = document.getElementById('completion-message');
            const resetBtn = document.getElementById('reset-btn');
            const navButtons = document.querySelectorAll('.nav-btn');

            let currentQuestionIndex = 0;
            let currentStepIndex = 0;

            // --- 函數 ---

            function renderAllKatex() {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\(', right: '\\)', display: false},
                        {left: '\\[', right: '\\]', display: true}
                    ],
                    throwOnError: false
                });
            }
            
            // 載入指定題目
            function loadQuestion(questionIndex) {
                currentQuestionIndex = questionIndex;
                currentStepIndex = 0;

                // 更新導覽列按鈕樣式
                navButtons.forEach((btn, index) => {
                    if (index === questionIndex) {
                        btn.classList.add('nav-btn-active');
                    } else {
                        btn.classList.remove('nav-btn-active');
                    }
                });

                // 載入題目
                const question = questions[currentQuestionIndex];
                problemArea.innerHTML = question.problemKatex;

                // 清空舊步驟並隱藏完成訊息
                stepsContainer.innerHTML = '';
                completionMessage.classList.add('step-hidden');

                // 載入第一個步驟
                loadStep(0);
                
                // 重新渲染 KaTeX
                renderAllKatex();
            }

            // 載入指定步驟
            function loadStep(stepIndex) {
                currentStepIndex = stepIndex;
                const question = questions[currentQuestionIndex];
                const step = question.steps[stepIndex];

                // 如果沒有下一個步驟，顯示完成訊息
                if (!step) {
                    completionMessage.classList.remove('step-hidden');
                    completionMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }

                const totalSteps = question.steps.length;
                const isLastStep = stepIndex === totalSteps - 1;
                const btnText = isLastStep ? "完成！" : "下一步";
                const btnClass = isLastStep ? "next-btn finish-btn" : "next-btn";
                const nextBtnId = `next-btn-${stepIndex}`;

                // 組合步驟 HTML
                let stepHtml = `
                    <div id="step-${stepIndex}" class="step-container">
                        <h2 class="step-title">${step.title}</h2>
                        <div class="step-progress">第 ${stepIndex + 1} 步 / 共 ${totalSteps} 步</div>
                        <p class="step-instruction">${step.instruction}</p>
                `;

                // 根據步驟類型加入不同的顯示
                if (step.katexDisplay) {
                    stepHtml += `<div class="katex-display-area" style="font-size: 1.8rem;">${step.katexDisplay}</div>`;
                }
                
                if (step.extraContent) {
                     stepHtml += `<div class="solution-text">${step.extraContent}</div>`;
                }

                stepHtml += `
                        <div class="text-center mt-8">
                            <button id="${nextBtnId}" class="${btnClass}">${btnText}</button>
                        </div>
                    </div>
                `;

                // 插入 HTML 並滾動到新步驟
                stepsContainer.insertAdjacentHTML('beforeend', stepHtml);
                const newStepElement = document.getElementById(`step-${stepIndex}`);
                newStepElement.scrollIntoView({ behavior: 'smooth', block: 'start' });

                // 重新渲染 KaTeX
                renderAllKatex();

                // 幫新按鈕加上事件監聽
                document.getElementById(nextBtnId).addEventListener('click', (e) => {
                    e.target.parentNode.remove(); // 點擊後移除按鈕及其容器
                    loadStep(stepIndex + 1); // 載入下一步
                });
            }

            // 重置目前題目
            function resetCurrentQuestion() {
                loadQuestion(currentQuestionIndex);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            // --- 初始設定 ---
            
            // 幫導覽列按鈕加上事件監聽
            navButtons.forEach((btn, index) => {
                btn.addEventListener('click', () => {
                    const idx = parseInt(btn.getAttribute('data-question-index'));
                    loadQuestion(idx);
                });
            });

            // 幫重置按鈕加上事件監聽
            resetBtn.addEventListener('click', resetCurrentQuestion);

            // 頁面載入時，自動載入第一題
            loadQuestion(0);
        });
    </script>
</body>
</html>