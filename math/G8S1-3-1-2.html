<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äºŒã€æå…¬å› å¼</title>
    <link rel="icon" href="dog.png" type="image/png">
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ğŸ“˜ å­—å‹å¼•å…¥ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chiron+GoRound+TC:wght@200..900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: "Chiron GoRound TC", sans-serif;
            font-weight: 400;
            font-style: normal;
            background: #a8d0e6; /* Fallback */
            background: linear-gradient(to bottom, #a8d0e6 0%, #f0f8ff 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            padding-bottom: 5rem; 
            user-select: none;
        }

        /* Slot (å¡«ç©ºæ ¼) æ¨£å¼ */
        .slot {
            width: 2.5rem;
            height: 2.5rem;
            font-size: 1.5rem; /* æ‰‹æ©Ÿç‰ˆå­—é«”ç¨å¾®ç¸®å°ä»¥å®¹ç´æ›´å¤šå­—å…ƒ */
            border-bottom: 3px solid #333;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            margin: 0 0.1rem;
            color: #111;
            transition: all 0.2s;
            flex-shrink: 0; 
            cursor: default;
        }
        @media (min-width: 768px) {
            .slot {
                width: 3rem;
                height: 3rem;
                font-size: 2rem;
                margin: 0 0.2rem;
            }
        }

        /* å·²å¡«å…¥å…§å®¹çš„ slot */
        .slot.filled {
            border-bottom-color: #007bff;
            color: #007bff;
            cursor: pointer;
        }
        .slot.filled:hover {
            background-color: rgba(0, 123, 255, 0.1);
            border-radius: 4px 4px 0 0;
        }

        /* æ‹¬è™Ÿçš„æ¨£å¼ */
        .paren {
            font-weight: bold;
            color: #333;
            margin: 0 0.1rem;
            line-height: 1;
            align-self: center;
        }

        /* é¸é …æŒ‰éˆ•æ¨£å¼ */
        .option-btn {
            padding: 0.5rem 1rem;
            font-size: 1.5rem;
            background-color: #ffffff;
            border: 2px solid #a0aec0;
            border-radius: 20px;
            font-weight: bold;
            color: #2d3748;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease-in-out;
            margin: 0.25rem;
        }
        @media (min-width: 768px) {
            .option-btn {
                padding: 0.75rem 1.25rem;
                font-size: 2rem;
            }
        }
        .option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
            border-color: #718096;
        }
        .option-btn:disabled {
            background-color: #e2e8f0;
            color: #a0aec0;
            border-color: #cbd5e0;
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* å‹¾å‹¾ SVG å‹•ç•« */
        .checkmark-path { stroke-dasharray: 50; stroke-dashoffset: 50; }
        .circle-bg { stroke-dasharray: 157; stroke-dashoffset: 157; }
        #correct-overlay:not(.hidden) .checkmark-path { animation: draw-check 0.5s 0.2s ease-out forwards; }
        #correct-overlay:not(.hidden) .circle-bg { animation: draw-circle 0.4s ease-out forwards; }
        @keyframes draw-check { to { stroke-dashoffset: 0; } }
        @keyframes draw-circle { to { stroke-dashoffset: 0; } }
    </style>
</head>
<body class="bg-gradient-to-b from-sky-300 to-sky-500 min-h-screen flex items-center justify-center p-4 pb-20">
    
    <div class="bg-white/70 backdrop-blur-sm p-4 md:p-10 rounded-3xl shadow-2xl max-w-5xl w-full border border-white/50">
        <!-- ä¸»æ¨™é¡Œ -->
        <h1 class="text-3xl md:text-5xl font-bold text-slate-800 text-center mb-2 tracking-wide">äºŒã€æå…¬å› å¼</h1>
        <p class="text-center text-slate-600 mb-6 font-medium">ä»”ç´°è§€å¯Ÿï¼Œå°‡å…¬å› å¼æå‡ºä¾†ä¸¦ç°¡åŒ–ç­”æ¡ˆ</p>

        <!-- å°è¦½èˆ‡æ¨™é¡Œå€åŸŸ -->
        <div class="flex justify-between items-center mb-6 bg-white/50 p-2 rounded-2xl">
            <button id="prev-btn" class="bg-slate-400 hover:bg-slate-500 text-white font-bold py-2 px-4 rounded-xl text-base md:text-lg shadow transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed">ä¸Šä¸€é¡Œ</button>
            <h2 id="question-counter" class="text-xl md:text-3xl font-bold text-slate-700 text-center px-2">ç¬¬ 1 / 8 é¡Œ</h2>
            <button id="next-btn" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-xl text-base md:text-lg shadow transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed">ä¸‹ä¸€é¡Œ</button>
        </div>

        <!-- é¡Œç›®å€åŸŸ -->
        <div class="text-center mb-6">
            <div id="question-expression" class="my-4 p-4 md:p-6 bg-white rounded-2xl shadow-inner inline-block text-2xl md:text-5xl font-bold text-slate-800 tracking-wide border-2 border-slate-100">
                <!-- é¡Œç›®å°‡å‹•æ…‹è¼‰å…¥ -->
            </div>
             <div id="hint-text" class="text-orange-600 font-bold text-lg h-8 mt-2 flex items-center justify-center"></div>
        </div>

        <!-- å¡«ç©ºå€åŸŸ -->
        <div id="slots-container" class="flex justify-center items-center mb-10 flex-wrap p-2 gap-1">
            <!-- ç­”æ¡ˆæ¬„ä½å°‡å‹•æ…‹è¼‰å…¥ -->
        </div>

        <!-- é¸é …å€åŸŸ -->
        <div id="options-container" class="flex justify-center flex-wrap gap-2 md:gap-4 mb-8 p-4 bg-slate-100/50 rounded-2xl border-2 border-white">
            <!-- æŒ‰éˆ•å‹•æ…‹ç”Ÿæˆ -->
        </div>

        <!-- æ§åˆ¶æŒ‰éˆ• -->
        <div class="text-center">
            <button id="check-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-10 rounded-2xl text-xl shadow-lg transition duration-200 transform hover:scale-105 mb-4">æª¢æŸ¥ç­”æ¡ˆ</button>
            <br>
            <button id="reset-btn" class="text-slate-500 hover:text-slate-700 font-bold py-2 px-4 text-lg transition duration-200 underline decoration-2 underline-offset-4">æ¸…é™¤é‡å¡«</button>
            
            <div id="message-area" class="mt-4 h-8 text-xl font-bold transition-all duration-300"></div>
        </div>
    </div> 

    <!-- ç­”å°äº†çš„ç¶ è‰²å‹¾å‹¾é®ç½© -->
    <div id="correct-overlay" class="fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm hidden">
        <div class="bg-white p-8 rounded-3xl shadow-2xl flex flex-col items-center transform scale-110">
            <svg class="w-32 h-32 md:w-48 md:h-48 mb-4" viewBox="0 0 52 52" xmlns="http://www.w3.org/2000/svg">
                <circle class="circle-bg" cx="26" cy="26" r="25" fill="none" stroke="#22c55e" stroke-width="3"/>
                <path class="checkmark-path" fill="none" stroke="#22c55e" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" d="M14.1 27.2l7.1 7.2 16.7-16.8" />
            </svg>
            <h2 class="text-3xl font-bold text-green-600 mb-2">ç­”å°äº†ï¼</h2>
            <p class="text-slate-500">è‡ªå‹•é€²å…¥ä¸‹ä¸€é¡Œ...</p>
        </div>
    </div>

    <!-- çµå°¾é é¢ (å…¨éƒ¨å®Œæˆ) -->
    <div id="completion-overlay" class="fixed inset-0 z-50 flex items-center justify-center bg-sky-100 hidden">
        <div class="text-center p-10">
            <div class="text-8xl mb-6">ğŸ†</div>
            <h1 class="text-4xl md:text-6xl font-bold text-slate-800 mb-6">å¤ªæ£’äº†ï¼</h1>
            <p class="text-2xl text-slate-600 mb-10">ä½ å·²ç¶“å®Œæˆäº†æ‰€æœ‰çš„ç·´ç¿’é¡Œï¼</p>
            <button onclick="location.reload()" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-4 px-12 rounded-full text-2xl shadow-xl transition hover:scale-110">
                å†ç©ä¸€æ¬¡
            </button>
        </div>
    </div>

    <footer class="fixed bottom-0 left-0 w-full text-center text-gray-500 text-sm bg-white bg-opacity-80 py-2 border-t border-gray-200 backdrop-blur-sm">
      Â© 2025 ç±³å…‹å¸«ï½œæ¡ç”¨ 
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh_TW" target="_blank" class="text-sky-600 hover:underline">
        CC BY-NC-SA 4.0 å‰µç”¨CCæˆæ¬Š
      </a>ï½œéå•†æ¥­ç”¨é€”æ­¡è¿è½‰è¼‰æˆ–æ”¹ç·¨ï¼Œè«‹ä¿ç•™ç½²åä¸¦é™„ä¸ŠåŸå§‹é€£çµã€‚
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- é¡Œåº«è³‡æ–™ (æ ¹æ“šåœ–ç‰‡ "ä¸‰ã€æå…¬å› å¼" æ›´æ–°) ---
            const questions = [
                {
                    // Q1: x(x-1) + 3(x-1)
                    questionHtml: 'x<span class="text-red-500">(x-1)</span> + 3<span class="text-red-500">(x-1)</span>',
                    // ç­”æ¡ˆ: (x-1)(x+3)
                    answerSlotsHtml: `
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="0"></div>
                        <div class="slot" data-index="1"></div>
                        <div class="slot" data-index="2"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="3"></div>
                        <div class="slot" data-index="4"></div>
                        <div class="slot" data-index="5"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>`,
                    options: ['x', '-', '1', 'x', '+', '3'],
                    correctAnswer: [
                        ['x', '-', '1', 'x', '+', '3'],
                        ['x', '+', '3', 'x', '-', '1']
                    ]
                },
                {
                    // Q2: 4(x+3) - 5x(x+3)
                    questionHtml: '4<span class="text-red-500">(x+3)</span> - 5x<span class="text-red-500">(x+3)</span>',
                    // ç­”æ¡ˆ: (x+3)(4-5x)
                    answerSlotsHtml: `
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="0"></div>
                        <div class="slot" data-index="1"></div>
                        <div class="slot" data-index="2"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="3"></div>
                        <div class="slot" data-index="4"></div>
                        <div class="slot" data-index="5"></div>
                        <div class="slot" data-index="6"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>`,
                    options: ['x', '+', '3', '4', '-', '5', 'x'],
                    correctAnswer: [
                        ['x', '+', '3', '4', '-', '5', 'x'],
                        ['4', '-', '5', 'x', 'x', '+', '3']
                    ]
                },
                {
                    // Q3: 3x(2x-3) + 5(2x-3)
                    questionHtml: '3x<span class="text-red-500">(2x-3)</span> + 5<span class="text-red-500">(2x-3)</span>',
                    // ç­”æ¡ˆ: (2x-3)(3x+5)
                    answerSlotsHtml: `
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="0"></div>
                        <div class="slot" data-index="1"></div>
                        <div class="slot" data-index="2"></div>
                        <div class="slot" data-index="3"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="4"></div>
                        <div class="slot" data-index="5"></div>
                        <div class="slot" data-index="6"></div>
                        <div class="slot" data-index="7"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>`,
                    options: ['2', 'x', '-', '3', '3', 'x', '+', '5'],
                    correctAnswer: [
                        ['2', 'x', '-', '3', '3', 'x', '+', '5'],
                        ['3', 'x', '+', '5', '2', 'x', '-', '3']
                    ]
                },
                {
                    // Q4: 2x(3x+2) - 7(3x+2)
                    questionHtml: '2x<span class="text-red-500">(3x+2)</span> - 7<span class="text-red-500">(3x+2)</span>',
                    // ç­”æ¡ˆ: (3x+2)(2x-7)
                    answerSlotsHtml: `
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="0"></div>
                        <div class="slot" data-index="1"></div>
                        <div class="slot" data-index="2"></div>
                        <div class="slot" data-index="3"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="4"></div>
                        <div class="slot" data-index="5"></div>
                        <div class="slot" data-index="6"></div>
                        <div class="slot" data-index="7"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>`,
                    options: ['3', 'x', '+', '2', '2', 'x', '-', '7'],
                    correctAnswer: [
                        ['3', 'x', '+', '2', '2', 'x', '-', '7'],
                        ['2', 'x', '-', '7', '3', 'x', '+', '2']
                    ]
                },
                {
                    // Q5: x(4x-1) - 8(4x-1)
                    questionHtml: 'x<span class="text-red-500">(4x-1)</span> - 8<span class="text-red-500">(4x-1)</span>',
                    // ç­”æ¡ˆ: (4x-1)(x-8)
                    answerSlotsHtml: `
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="0"></div>
                        <div class="slot" data-index="1"></div>
                        <div class="slot" data-index="2"></div>
                        <div class="slot" data-index="3"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="4"></div>
                        <div class="slot" data-index="5"></div>
                        <div class="slot" data-index="6"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>`,
                    options: ['4', 'x', '-', '1', 'x', '-', '8'],
                    correctAnswer: [
                        ['4', 'x', '-', '1', 'x', '-', '8'],
                        ['x', '-', '8', '4', 'x', '-', '1']
                    ]
                },
                {
                    // Q6: (3x+5)^2 - (3x+5) -> (3x+5)(3x+5 - 1) = (3x+5)(3x+4)
                    questionHtml: '(3x+5)<sup class="text-sm">2</sup> - <span class="text-red-500">(3x+5)</span>',
                    hint: 'æç¤ºï¼šå¹³æ–¹ä»£è¡¨æœ‰å…©å€‹(3x+5)ï¼Œæå‡ºä¸€å€‹å¾Œï¼Œå¦ä¸€å€‹è¦æ¸›1å–”ï¼ (3x+5-1)æ˜¯ï¼Ÿ',
                    // ç­”æ¡ˆ: (3x+5)(3x+4)
                    answerSlotsHtml: `
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="0"></div>
                        <div class="slot" data-index="1"></div>
                        <div class="slot" data-index="2"></div>
                        <div class="slot" data-index="3"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="4"></div>
                        <div class="slot" data-index="5"></div>
                        <div class="slot" data-index="6"></div>
                        <div class="slot" data-index="7"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>`,
                    options: ['3', 'x', '+', '5', '3', 'x', '+', '4'],
                    correctAnswer: [
                        ['3', 'x', '+', '5', '3', 'x', '+', '4'],
                        ['3', 'x', '+', '4', '3', 'x', '+', '5']
                    ]
                },
                {
                    // Q7: 2x(7x+3) + (7x+3)(x+5) -> (7x+3)(2x + x+5) = (7x+3)(3x+5)
                    questionHtml: '2x<span class="text-red-500">(7x+3)</span> + <span class="text-red-500">(7x+3)</span>(x+5)',
                    hint: 'æç¤ºï¼šæå‡ºå…¬å› å¼å¾Œï¼Œå‰©ä¸‹çš„éƒ¨åˆ† 2x+(x+5) è¦åˆä½µå–”ï¼',
                    // ç­”æ¡ˆ: (7x+3)(3x+5)
                    answerSlotsHtml: `
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="0"></div>
                        <div class="slot" data-index="1"></div>
                        <div class="slot" data-index="2"></div>
                        <div class="slot" data-index="3"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="4"></div>
                        <div class="slot" data-index="5"></div>
                        <div class="slot" data-index="6"></div>
                        <div class="slot" data-index="7"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>`,
                    options: ['7', 'x', '+', '3', '3', 'x', '+', '5'],
                    correctAnswer: [
                        ['7', 'x', '+', '3', '3', 'x', '+', '5'],
                        ['3', 'x', '+', '5', '7', 'x', '+', '3']
                    ]
                },
                {
                    // Q8: 10x(2x+5) - (2x+5)(x+4) -> (2x+5)(10x - (x+4)) = (2x+5)(9x-4)
                    questionHtml: '10x<span class="text-red-500">(2x+5)</span> - <span class="text-red-500">(2x+5)</span>(x+4)',
                    hint: 'æ³¨æ„ï¼šå‰©ä¸‹çš„éƒ¨åˆ†æ˜¯ 10x - (x+4)ï¼Œå»æ‹¬è™Ÿè¨˜å¾—è¦è®Šè™Ÿï¼',
                    // ç­”æ¡ˆ: (2x+5)(9x-4)
                    answerSlotsHtml: `
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="0"></div>
                        <div class="slot" data-index="1"></div>
                        <div class="slot" data-index="2"></div>
                        <div class="slot" data-index="3"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>
                        <span class="paren text-4xl md:text-6xl">(</span>
                        <div class="slot" data-index="4"></div>
                        <div class="slot" data-index="5"></div>
                        <div class="slot" data-index="6"></div>
                        <div class="slot" data-index="7"></div>
                        <span class="paren text-4xl md:text-6xl">)</span>`,
                    options: ['2', 'x', '+', '5', '9', 'x', '-', '4'],
                    correctAnswer: [
                        ['2', 'x', '+', '5', '9', 'x', '-', '4'],
                        ['9', 'x', '-', '4', '2', 'x', '+', '5']
                    ]
                }
            ];

            // --- ç‹€æ…‹ç®¡ç† ---
            let currentQuestionIndex = 0;
            let slots = [];
            let autoAdvanceTimer = null;

            // --- DOM å…ƒç´  ---
            const optionsContainer = document.getElementById('options-container');
            const messageArea = document.getElementById('message-area');
            const hintText = document.getElementById('hint-text');
            const checkBtn = document.getElementById('check-btn');
            const resetBtn = document.getElementById('reset-btn');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const questionCounter = document.getElementById('question-counter');
            const questionExpression = document.getElementById('question-expression');
            const slotsContainer = document.getElementById('slots-container');
            const correctOverlay = document.getElementById('correct-overlay');
            const completionOverlay = document.getElementById('completion-overlay');

            // --- å‡½å¼ ---

            function loadQuestion(index) {
                if (autoAdvanceTimer) clearTimeout(autoAdvanceTimer);
                currentQuestionIndex = index;
                const question = questions[currentQuestionIndex];

                // 1. æ›´æ–°é¡Œè™Ÿã€é¡Œç›®ã€æç¤º
                questionCounter.textContent = `ç¬¬ ${index + 1} / ${questions.length} é¡Œ`;
                questionExpression.innerHTML = question.questionHtml;
                hintText.textContent = question.hint || '';

                // 2. æ¸²æŸ“ç­”æ¡ˆæ¬„ä½
                slotsContainer.innerHTML = question.answerSlotsHtml;

                // 3. é‡è¨­æ¬„ä½ç‹€æ…‹
                const totalSlots = question.correctAnswer[0].length;
                slots = new Array(totalSlots).fill(null);

                // 4. ç¶å®š slot é»æ“Šäº‹ä»¶
                const slotElements = slotsContainer.querySelectorAll('.slot');
                slotElements.forEach(slot => {
                    slot.addEventListener('click', handleSlotClick);
                });

                // 5. æ¸²æŸ“é¸é …æŒ‰éˆ•
                optionsContainer.innerHTML = '';
                const questionOptions = question.options.map((val, i) => ({
                    id: `opt-${i}`,
                    value: val
                }));
                // éš¨æ©Ÿæ‰“äº‚é¸é …
                const shuffledOptions = [...questionOptions].sort(() => Math.random() - 0.5);

                shuffledOptions.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.id = opt.id;
                    btn.dataset.value = opt.value;
                    btn.textContent = opt.value;
                    btn.className = 'option-btn';
                    btn.addEventListener('click', handleOptionClick);
                    optionsContainer.appendChild(btn);
                });

                // 6. æ¸…ç©ºè¨Šæ¯èˆ‡é‡ç½®UI
                messageArea.textContent = '';
                messageArea.className = 'mt-4 h-8 text-xl font-bold transition-all duration-300';
                correctOverlay.classList.add('hidden');
                completionOverlay.classList.add('hidden');

                // 7. æ›´æ–°å°è¦½æŒ‰éˆ•
                prevBtn.disabled = index === 0;
                nextBtn.disabled = index === questions.length - 1;
            }

            function handleOptionClick(event) {
                const clickedBtn = event.currentTarget;
                const value = clickedBtn.dataset.value;
                const optionId = clickedBtn.id;

                // æ‰¾åˆ°ç¬¬ä¸€å€‹ç©ºçš„ slot
                const firstEmptySlotIndex = slots.findIndex(s => s === null);

                if (firstEmptySlotIndex !== -1) {
                    // æ›´æ–°è³‡æ–™ç‹€æ…‹
                    slots[firstEmptySlotIndex] = { value: value, optionId: optionId };

                    // æ›´æ–° UI
                    // æ³¨æ„ï¼šé€™è£¡éœ€è¦é‡æ–°æŸ¥è©¢ï¼Œå› ç‚º innerHTML é‡ç¹ªé
                    const slotElements = slotsContainer.querySelectorAll('.slot');
                    const slotElement = slotElements[firstEmptySlotIndex];
                    
                    if(slotElement) {
                        slotElement.textContent = value;
                        slotElement.classList.add('filled');
                        slotElement.dataset.optionId = optionId; 
                    }

                    // ç¦ç”¨æŒ‰éˆ•
                    clickedBtn.disabled = true;
                    
                    // æ¸…é™¤éŒ¯èª¤è¨Šæ¯
                    if (messageArea.classList.contains('text-red-500')) {
                        messageArea.textContent = '';
                    }
                }
            }

            function handleSlotClick(event) {
                const clickedSlot = event.currentTarget;
                const indexStr = clickedSlot.dataset.index;
                if (!indexStr) return; // é˜²å‘†
                
                const slotIndex = parseInt(indexStr, 10);
                const currentSlotData = slots[slotIndex];

                if (currentSlotData) {
                    const optionId = currentSlotData.optionId;

                    // æ¢å¾©æŒ‰éˆ•
                    const optionBtn = document.getElementById(optionId);
                    if (optionBtn) {
                        optionBtn.disabled = false;
                    }

                    // æ¸…ç©ºè³‡æ–™
                    slots[slotIndex] = null;

                    // æ›´æ–° UI
                    clickedSlot.textContent = '';
                    clickedSlot.classList.remove('filled');
                    clickedSlot.dataset.optionId = '';
                    
                    messageArea.textContent = '';
                }
            }

            function checkAnswer() {
                const question = questions[currentQuestionIndex];

                if (slots.some(s => s === null)) {
                    messageArea.textContent = 'é‚„æœ‰ç©ºæ ¼æ²’å¡«å®Œå–”ï¼';
                    messageArea.className = 'mt-4 h-8 text-xl font-bold text-orange-500';
                    return;
                }

                const currentAnswer = slots.map(s => s.value);
                const currentAnswerString = JSON.stringify(currentAnswer);
                let isCorrect = false;

                // æ¯”å°å¤šçµ„æ­£ç¢ºç­”æ¡ˆ
                for (const validAnswer of question.correctAnswer) {
                    if (JSON.stringify(validAnswer) === currentAnswerString) {
                        isCorrect = true;
                        break;
                    }
                }

                if (isCorrect) {
                    // é¡¯ç¤ºæˆåŠŸå‹•ç•«
                    correctOverlay.classList.remove('hidden');
                    
                    // è‡ªå‹•è·³é¡Œé‚è¼¯
                    autoAdvanceTimer = setTimeout(() => {
                        correctOverlay.classList.add('hidden');
                        if (currentQuestionIndex < questions.length - 1) {
                            loadQuestion(currentQuestionIndex + 1);
                        } else {
                            // å…¨éƒ¨å®Œæˆ
                            completionOverlay.classList.remove('hidden');
                        }
                    }, 1500); // 1.5ç§’å¾Œè·³è½‰

                } else {
                    messageArea.textContent = 'ç­”æ¡ˆä¸å¤ªå°ï¼Œå†æª¢æŸ¥çœ‹çœ‹ï¼';
                    messageArea.className = 'mt-4 h-8 text-xl font-bold text-red-500';
                }
            }

            // --- äº‹ä»¶ç¶å®š ---
            prevBtn.addEventListener('click', () => {
                if (currentQuestionIndex > 0) loadQuestion(currentQuestionIndex - 1);
            });

            nextBtn.addEventListener('click', () => {
                if (currentQuestionIndex < questions.length - 1) loadQuestion(currentQuestionIndex + 1);
            });

            checkBtn.addEventListener('click', checkAnswer);
            
            resetBtn.addEventListener('click', () => {
                loadQuestion(currentQuestionIndex);
            });

            // å•Ÿå‹•
            loadQuestion(0);
        });
    </script>
</body>
</html>