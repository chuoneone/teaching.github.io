<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>互動學習單：根式的乘除運算</title>
    <link rel="icon" href="dog.png" type="image/png">
    
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 引入 KaTeX 數學公式 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" xintegrity="sha384-nB0mCrOMXqGshaCNdrA1YFsuVLRodGohlrmREQN/sRCJMFinN+EL1FNTL9PKSJ63" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" xintegrity="sha384-7/YYLCCoTddN+BTiLuK+qGfS6rXl1Pii1FkL4S/pRFH5LPC2S8rwdvF/dLT9VlqH" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" xintegrity="sha384-43gviWU0YVjaDtb/Gf1ESgOG+IPtSEAU+NwG5hSXT4ZabKmnreqN1Q+EAU0VLl6/+" crossorigin="anonymous"></script>
    
    <!-- 引入 Chiron GoRound TC 字型 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chiron+GoRound+TC:wght@200..900&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: "Chiron GoRound TC", sans-serif;
            font-weight: 400;
            font-style: normal;
            background-color: #f8fafc;
        }
        
        .highlight {
            background: linear-gradient(to top, #fef08a 50%, transparent 50%);
            padding: 0 0.2rem;
            border-radius: 3px;
        }

        .step-container {
            background-color: white;
            border-radius: 0.75rem;
            border: 1px solid #e2e8f0;
            padding: 1.5rem;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            /* 加上動畫，讓步驟出現更流暢 */
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 隱藏的步驟 */
        .step-hidden {
            display: none;
        }
        
        /* 導覽列按鈕 */
        .nav-btn {
            padding: 0.5rem 1rem;
            font-weight: 600;
            border-radius: 0.5rem;
            background-color: #e2e8f0;
            color: #475569;
            transition: all 0.2s;
            cursor: pointer;
        }
        .nav-btn:hover {
            background-color: #cbd5e1;
        }
        /* 導覽列啟用中按鈕 */
        .nav-btn-active {
            background-color: #3b82f6;
            color: white;
        }
        .nav-btn-active:hover {
            background-color: #2563eb;
        }

        /* 下一步按鈕 */
        .next-btn {
            background-color: #3b82f6; /* 藍色 */
            color: white;
            font-weight: 600;
            padding: 0.6rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
            border: none;
            cursor: pointer;
        }
        .next-btn:hover {
            background-color: #2563eb;
        }
        .next-btn:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        /* 最終按鈕 */
        .finish-btn {
             background-color: #10b981; /* 綠色 */
        }
        .finish-btn:hover {
             background-color: #059669;
        }
        
        .katex-display-area {
            font-size: 2.25rem; 
            color: #1e293b;
            padding: 1.5rem;
            background-color: #f1f5f9;
            border-radius: 0.5rem;
            text-align: center;
            margin-bottom: 1rem;
            overflow-x: auto;
        }
        
        .step-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }
        
        .step-progress {
            font-size: 0.9rem;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 1rem;
        }
        
        .step-instruction {
            color: #334155;
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }
        
        .solution-text {
            font-size: 1.5rem;
            color: #1e293b;
            text-align: center;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body class="min-h-screen pb-24">

    <div class="max-w-3xl mx-auto p-4 md:p-8">
        
        <!-- 導覽列 -->
        <nav class="flex justify-center flex-wrap gap-2 mb-8" id="nav-container">
            <button class="nav-btn" data-question-index="0">第 1 題</button>
            <button class="nav-btn" data-question-index="1">第 2 題</button>
            <button class="nav-btn" data-question-index="2">第 3 題</button>
            <button class="nav-btn" data-question-index="3">第 4 題</button>
            <button class="nav-btn" data-question-index="4">第 5 題</button>
            <button class="nav-btn" data-question-index="5">第 6 題</button>
            <button class="nav-btn" data-question-index="6">第 7 題</button>
            <button class="nav-btn" data-question-index="7">第 8 題</button>
            <button class="nav-btn" data-question-index="8">第 9 題</button>
            <button class="nav-btn" data-question-index="9">第 10 題</button>
            <button class="nav-btn" data-question-index="10">第 11 題</button>
            <button class="nav-btn" data-question-index="11">第 12 題</button>
            <button class="nav-btn" data-question-index="12">第 13 題</button>
            <button class="nav-btn" data-question-index="13">第 14 題</button>
        </nav>

        <header class="text-center my-8">
            <h1 class="text-4xl font-bold text-slate-800">六、根式的乘除運算與有理化</h1>
            <p class="text-lg text-slate-500 mt-2">計算下列各式，並將結果化為最簡根式：</p>
        </header>

        <!-- 題目顯示區 (動態載入) -->
        <div class="katex-display-area" id="problem-area">
            <!-- JS will fill this -->
        </div>

        <!-- 逐步解題容器 (動態載入) -->
        <div class="space-y-6" id="steps-container">
            <!-- JS will fill this -->
        </div>
            
        <!-- 完成訊息 -->
        <div id="completion-message" class="text-center mt-8 p-6 bg-green-100 border-2 border-green-400 rounded-lg step-hidden">
            <h2 class="text-3xl font-bold text-green-700">恭喜你，完成練習！</h2>
            <p class="mt-2 text-green-600 text-lg">你已經學會這題「有理化分母」的技巧了！</p>
            <button id="completion-action-btn" class="mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg transition-colors text-lg">
                <!-- JS 會填入按鈕文字 -->
            </button>
        </div>

    </div> <!-- end max-w-3xl -->

    <!-- 頁尾 -->
    <footer class="fixed bottom-0 left-0 w-full text-center text-gray-400 text-sm bg-white bg-opacity-80 py-2 border-t border-gray-200 backdrop-blur-sm">
      © 2025 特教米克師｜採用 
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh_TW" target="_blank" class="text-sky-600 hover:underline">
        CC BY-NC-SA 4.0 創用CC授權
      </a>｜非商業用途歡迎轉載或改編，請保留署名並附上原始連結。
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 題目資料庫 ---
            const questions = [
                { // 第 1 題
                    problemKatex: "$$\\sqrt{2} \\times \\sqrt{\\frac{7}{6}}$$",
                    steps: [
                        {
                            title: "步驟一：根號相乘",
                            instruction: "將兩個根號<span class='highlight'>合併成一個根號</span>並相乘：",
                            katexDisplay: "$$\\sqrt{2} \\times \\sqrt{\\frac{7}{6}} = \\sqrt{2 \\times \\frac{7}{6}}$$",
                        },
                        {
                            title: "步驟二：根號內計算",
                            instruction: "計算根號內的乘法：",
                            katexDisplay: "$$\\sqrt{\\frac{14}{6}}$$",
                        },
                        {
                            title: "步驟三：根號內約分",
                            instruction: "將根號內的分數<span class='highlight'>上下同除以 2</span> 來約分：",
                            katexDisplay: "$$\\sqrt{\\frac{14}{6}} = \\sqrt{\\frac{7}{3}}$$",
                        },
                        {
                            title: "步驟四：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$\\sqrt{\\frac{7}{3}} = \\frac{\\sqrt{7}}{\\sqrt{3}}$$",
                        },
                        {
                            title: "步驟五：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{3}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{3}$</span>。",
                            katexDisplay: "$$\\frac{\\sqrt{7}}{\\sqrt{3}} = \\frac{\\sqrt{7} \\times \\sqrt{3}}{\\sqrt{3} \\times \\sqrt{3}}$$",
                        },
                        {
                            title: "步驟六：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$\\sqrt{7} \\times \\sqrt{3} = \\sqrt{21}$",
                            solutionDen: "$\\sqrt{3} \\times \\sqrt{3} = 3$",
                        },
                        {
                            title: "步驟七：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來，得到答案：",
                            katexDisplay: "$$\\frac{\\sqrt{21}}{3}$$",
                        }
                    ]
                },
                { // 第 2 題
                    problemKatex: "$$\\sqrt{\\frac{2}{5}} \\times \\left(-\\sqrt{\\frac{1}{3}}\\right)$$",
                    steps: [
                        {
                            title: "步驟一：判斷正負",
                            instruction: "正數乘以負數，答案是<span class='highlight'>負數</span>。",
                            katexDisplay: "$$\\sqrt{\\frac{2}{5}} \\times \\left(-\\sqrt{\\frac{1}{3}}\\right) = -\\left(\\sqrt{\\frac{2}{5}} \\times \\sqrt{\\frac{1}{3}}\\right)$$",
                        },
                        {
                            title: "步驟二：根號相乘",
                            instruction: "將兩個根號<span class='highlight'>合併成一個根號</span>並相乘：",
                            katexDisplay: "$$-\\sqrt{\\frac{2}{5} \\times \\frac{1}{3}}$$",
                        },
                        {
                            title: "步驟三：根號內計算",
                            instruction: "計算根號內的乘法：",
                            katexDisplay: "$$-\\sqrt{\\frac{2}{15}}$$",
                        },
                        {
                            title: "步驟四：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$-\\sqrt{\\frac{2}{15}} = -\\frac{\\sqrt{2}}{\\sqrt{15}}$$",
                        },
                        {
                            title: "步驟五：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{15}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{15}$</span>。",
                            katexDisplay: "$$-\\frac{\\sqrt{2}}{\\sqrt{15}} = -\\frac{\\sqrt{2} \\times \\sqrt{15}}{\\sqrt{15} \\times \\sqrt{15}}$$",
                        },
                        {
                            title: "步驟六：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$\\sqrt{2} \\times \\sqrt{15} = \\sqrt{30}$",
                            solutionDen: "$\\sqrt{15} \\times \\sqrt{15} = 15$",
                        },
                        {
                            title: "步驟七：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來（別忘了負號）：",
                            katexDisplay: "$$-\\frac{\\sqrt{30}}{15}$$",
                        }
                    ]
                },
                { // 第 3 題
                    problemKatex: "$$\\frac{\\sqrt{3}}{\\sqrt{5}} \\times \\frac{\\sqrt{6}}{\\sqrt{3}}$$",
                    steps: [
                        {
                            title: "步驟一：觀察",
                            instruction: "這題有更快的解法！我們發現分子和分母<span class='highlight'>都有 $\\sqrt{3}$</span>。",
                            katexDisplay: "$$\\frac{\\sqrt{3}}{\\sqrt{5}} \\times \\frac{\\sqrt{6}}{\\sqrt{3}}$$",
                        },
                        {
                            title: "步驟二：直接約分",
                            instruction: "先將分子和分母的 $\\sqrt{3}$ 直接約掉：",
                            katexDisplay: "$$\\frac{\\cancel{\\sqrt{3}}}{\\sqrt{5}} \\times \\frac{\\sqrt{6}}{\\cancel{\\sqrt{3}}} = \\frac{\\sqrt{6}}{\\sqrt{5}}$$",
                        },
                        {
                            title: "步驟三：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{5}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{5}$</span>。",
                            katexDisplay: "$$\\frac{\\sqrt{6}}{\\sqrt{5}} = \\frac{\\sqrt{6} \\times \\sqrt{5}}{\\sqrt{5} \\times \\sqrt{5}}$$",
                        },
                        {
                            title: "步驟四：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$\\sqrt{6} \\times \\sqrt{5} = \\sqrt{30}$",
                            solutionDen: "$\\sqrt{5} \\times \\sqrt{5} = 5$",
                        },
                        {
                            title: "步驟五：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來，得到答案：",
                            katexDisplay: "$$\\frac{\\sqrt{30}}{5}$$",
                        }
                    ]
                },
                { // 第 4 題
                    problemKatex: "$$\\sqrt{\\frac{7}{4}} \\times \\sqrt{\\frac{16}{21}}$$",
                    steps: [
                        {
                            title: "步驟一：根號相乘",
                            instruction: "將兩個根號<span class='highlight'>合併成一個根號</span>並相乘：",
                            katexDisplay: "$$\\sqrt{\\frac{7}{4} \\times \\frac{16}{21}}$$",
                        },
                        {
                            title: "步驟二：根號內約分",
                            instruction: "在根號內進行約分：<br> $7$ 和 $21$ 約掉（剩 $1$ 和 $3$）<br> $4$ 和 $16$ 約掉（剩 $1$ 和 $4$）",
                            katexDisplay: "$$\\sqrt{\\frac{\\cancel{7}^1}{\\cancel{4}_1} \\times \\frac{\\cancel{16}^4}{\\cancel{21}_3}} = \\sqrt{\\frac{4}{3}}$$",
                        },
                        {
                            title: "步驟三：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$\\sqrt{\\frac{4}{3}} = \\frac{\\sqrt{4}}{\\sqrt{3}}$$",
                        },
                        {
                            title: "步驟四：化簡分子",
                            instruction: "因為 $\\sqrt{4} = 2$，我們可以化簡分子：",
                            katexDisplay: "$$\\frac{2}{\\sqrt{3}}$$",
                        },
                        {
                            title: "步驟五：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{3}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{3}$</span>。",
                            katexDisplay: "$$\\frac{2}{\\sqrt{3}} = \\frac{2 \\times \\sqrt{3}}{\\sqrt{3} \\times \\sqrt{3}}$$",
                        },
                        {
                            title: "步驟六：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$2 \\times \\sqrt{3} = 2\\sqrt{3}$",
                            solutionDen: "$\\sqrt{3} \\times \\sqrt{3} = 3$",
                        },
                        {
                            title: "步驟七：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來，得到答案：",
                            katexDisplay: "$$\\frac{2\\sqrt{3}}{3}$$",
                        }
                    ]
                },
                { // 第 5 題
                    problemKatex: "$$-\\frac{\\sqrt{11}}{\\sqrt{10}} \\times \\sqrt{\\frac{15}{33}}$$",
                    steps: [
                        {
                            title: "步驟一：判斷正負",
                            instruction: "負數乘以正數，答案是<span class='highlight'>負數</span>。",
                            katexDisplay: "$$-\\left(\\frac{\\sqrt{11}}{\\sqrt{10}} \\times \\sqrt{\\frac{15}{33}}\\right)$$",
                        },
                        {
                            title: "步驟二：拆開根號",
                            instruction: "將第二項的根號拆開，方便計算：",
                            katexDisplay: "$$-\\left(\\frac{\\sqrt{11}}{\\sqrt{10}} \\times \\frac{\\sqrt{15}}{\\sqrt{33}}\\right)$$",
                        },
                        {
                            title: "步驟三：合併為一個根號",
                            instruction: "將所有根號合併，並在裡面進行約分：",
                            katexDisplay: "$$-\\sqrt{\\frac{11 \\times 15}{10 \\times 33}} = -\\sqrt{\\frac{\\cancel{11}^1 \\times \\cancel{15}^3}{\\cancel{10}_2 \\times \\cancel{33}_3}}$$",
                        },
                         {
                            title: "步驟四：約分後",
                            instruction: "約分後，我們發現分子和分母還有 $3$ 可以約掉：",
                            katexDisplay: "$$-\\sqrt{\\frac{3}{2 \\times 3}} = -\\sqrt{\\frac{\\cancel{3}^1}{2 \\times \\cancel{3}_1}} = -\\sqrt{\\frac{1}{2}}$$",
                        },
                        {
                            title: "步驟五：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$-\\sqrt{\\frac{1}{2}} = -\\frac{\\sqrt{1}}{\\sqrt{2}} = -\\frac{1}{\\sqrt{2}}$$",
                        },
                        {
                            title: "步驟六：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{2}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{2}$</span>。",
                            katexDisplay: "$$-\\frac{1}{\\sqrt{2}} = -\\frac{1 \\times \\sqrt{2}}{\\sqrt{2} \\times \\sqrt{2}}$$",
                        },
                        {
                            title: "步驟七：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$1 \\times \\sqrt{2} = \\sqrt{2}$",
                            solutionDen: "$\\sqrt{2} \\times \\sqrt{2} = 2$",
                        },
                        {
                            title: "步驟八：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來（別忘了負號）：",
                            katexDisplay: "$$-\\frac{\\sqrt{2}}{2}$$",
                        }
                    ]
                },
                { // 第 6 題
                    problemKatex: "$$-\\frac{\\sqrt{13}}{\\sqrt{48}} \\times (-\\sqrt{3})$$",
                    steps: [
                        {
                            title: "步驟一：判斷正負",
                            instruction: "負數乘以負數，答案是<span class='highlight'>正數</span>。",
                            katexDisplay: "$$\\frac{\\sqrt{13}}{\\sqrt{48}} \\times \\sqrt{3}$$",
                        },
                        {
                            title: "步驟二：合併計算",
                            instruction: "將 $\\sqrt{3}$ 乘到分子，並合併成一個根號：",
                            katexDisplay: "$$\\frac{\\sqrt{13} \\times \\sqrt{3}}{\\sqrt{48}} = \\sqrt{\\frac{13 \\times 3}{48}}$$",
                        },
                        {
                            title: "步驟三：根號內約分",
                            instruction: "計算 $13 \\times 3 = 39$，或者直接用 $3$ 和 $48$ 約分：",
                            katexDisplay: "$$\\sqrt{\\frac{13 \\times \\cancel{3}^1}{\\cancel{48}_{16}}} = \\sqrt{\\frac{13}{16}}$$",
                        },
                        {
                            title: "步驟四：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$\\sqrt{\\frac{13}{16}} = \\frac{\\sqrt{13}}{\\sqrt{16}}$$",
                        },
                        {
                            title: "步驟五：化簡分母",
                            instruction: "因為 $\\sqrt{16} = 4$，我們可以化簡分母，得到最終答案（此題不需有理化）：",
                            katexDisplay: "$$\\frac{\\sqrt{13}}{4}$$",
                        }
                    ]
                },
                { // 第 7 題
                    problemKatex: "$$\\frac{\\sqrt{6}}{\\sqrt{5}} \\times \\left(-\\sqrt{\\frac{15}{14}}\\right)$$",
                    steps: [
                        {
                            title: "步驟一：判斷正負",
                            instruction: "正數乘以負數，答案是<span class='highlight'>負數</span>。",
                            katexDisplay: "$$-\\left(\\frac{\\sqrt{6}}{\\sqrt{5}} \\times \\sqrt{\\frac{15}{14}}\\right)$$",
                        },
                        {
                            title: "步驟二：合併為一個根號",
                            instruction: "將所有根號合併，並在裡面準備約分：",
                            katexDisplay: "$$-\\sqrt{\\frac{6 \\times 15}{5 \\times 14}}$$",
                        },
                        {
                            title: "步驟三：根號內約分",
                            instruction: "約分：<br> $5$ 和 $15$ 約掉（剩 $1$ 和 $3$）<br> $6$ 和 $14$ 約掉（剩 $3$ 和 $7$）",
                            katexDisplay: "$$-\\sqrt{\\frac{\\cancel{6}^3 \\times \\cancel{15}^3}{\\cancel{5}_1 \\times \\cancel{14}_7}} = -\\sqrt{\\frac{3 \\times 3}{7}}$$",
                        },
                        {
                            title: "步驟四：根號內計算",
                            instruction: "計算根號內的乘法：",
                            katexDisplay: "$$-\\sqrt{\\frac{9}{7}}$$",
                        },
                        {
                            title: "步驟五：拆開根號並化簡",
                            instruction: "將根號拆開，並化簡 $\\sqrt{9} = 3$：",
                            katexDisplay: "$$-\\frac{\\sqrt{9}}{\\sqrt{7}} = -\\frac{3}{\\sqrt{7}}$$",
                        },
                        {
                            title: "步驟六：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{7}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{7}$</span>。",
                            katexDisplay: "$$-\\frac{3}{\\sqrt{7}} = -\\frac{3 \\times \\sqrt{7}}{\\sqrt{7} \\times \\sqrt{7}}$$",
                        },
                        {
                            title: "步驟七：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$3 \\times \\sqrt{7} = 3\\sqrt{7}$",
                            solutionDen: "$\\sqrt{7} \\times \\sqrt{7} = 7$",
                        },
                        {
                            title: "步驟八：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來（別忘了負號）：",
                            katexDisplay: "$$-\\frac{3\\sqrt{7}}{7}$$",
                        }
                    ]
                },
                { // 第 8 題
                    problemKatex: "$$\\sqrt{7} \\div \\sqrt{21}$$",
                    steps: [
                        {
                            title: "步驟一：合併為一個根號",
                            instruction: "將兩個根號<span class='highlight'>合併成一個根號</span>並相除：",
                            katexDisplay: "$$\\sqrt{\\frac{7}{21}}$$",
                        },
                        {
                            title: "步驟二：根號內約分",
                            instruction: "將根號內的分數<span class='highlight'>上下同除以 7</span> 來約分：",
                            katexDisplay: "$$\\sqrt{\\frac{7}{21}} = \\sqrt{\\frac{1}{3}}$$",
                        },
                        {
                            title: "步驟三：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$\\sqrt{\\frac{1}{3}} = \\frac{\\sqrt{1}}{\\sqrt{3}} = \\frac{1}{\\sqrt{3}}$$",
                        },
                        {
                            title: "步驟四：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{3}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{3}$</span>。",
                            katexDisplay: "$$\\frac{1}{\\sqrt{3}} = \\frac{1 \\times \\sqrt{3}}{\\sqrt{3} \\times \\sqrt{3}}$$",
                        },
                        {
                            title: "步驟五：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$1 \\times \\sqrt{3} = \\sqrt{3}$",
                            solutionDen: "$\\sqrt{3} \\times \\sqrt{3} = 3$",
                        },
                        {
                            title: "步驟六：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來，得到答案：",
                            katexDisplay: "$$\\frac{\\sqrt{3}}{3}$$",
                        }
                    ]
                },
                { // 第 9 題
                    problemKatex: "$$\\sqrt{\\frac{1}{12}} \\div \\sqrt{\\frac{1}{6}}$$",
                    steps: [
                        {
                            title: "步驟一：改成乘法",
                            instruction: "除以一個數，等於<span class='highlight'>乘上它的倒數</span>：",
                            katexDisplay: "$$\\sqrt{\\frac{1}{12}} \\times \\sqrt{\\frac{6}{1}}$$",
                        },
                        {
                            title: "步驟二：合併為一個根號",
                            instruction: "將兩個根號<span class='highlight'>合併成一個根號</span>並相乘：",
                            katexDisplay: "$$\\sqrt{\\frac{1}{12} \\times \\frac{6}{1}} = \\sqrt{\\frac{6}{12}}$$",
                        },
                        {
                            title: "步驟三：根號內約分",
                            instruction: "將根號內的分數<span class='highlight'>上下同除以 6</span> 來約分：",
                            katexDisplay: "$$\\sqrt{\\frac{6}{12}} = \\sqrt{\\frac{1}{2}}$$",
                        },
                        {
                            title: "步驟四：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$\\sqrt{\\frac{1}{2}} = \\frac{\\sqrt{1}}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}}$$",
                        },
                        {
                            title: "步驟五：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{2}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{2}$</span>。",
                            katexDisplay: "$$\\frac{1}{\\sqrt{2}} = \\frac{1 \\times \\sqrt{2}}{\\sqrt{2} \\times \\sqrt{2}}$$",
                        },
                        {
                            title: "步驟六：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$1 \\times \\sqrt{2} = \\sqrt{2}$",
                            solutionDen: "$\\sqrt{2} \\times \\sqrt{2} = 2$",
                        },
                        {
                            title: "步驟七：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來，得到答案：",
                            katexDisplay: "$$\\frac{\\sqrt{2}}{2}$$",
                        }
                    ]
                },
                { // 第 10 題
                    problemKatex: "$$\\sqrt{\\frac{4}{7}} \\div \\sqrt{\\frac{5}{14}}$$",
                    steps: [
                        {
                            title: "步驟一：改成乘法",
                            instruction: "除以一個數，等於<span class='highlight'>乘上它的倒數</span>：",
                            katexDisplay: "$$\\sqrt{\\frac{4}{7}} \\times \\sqrt{\\frac{14}{5}}$$",
                        },
                        {
                            title: "步驟二：合併為一個根號",
                            instruction: "將兩個根號<span class='highlight'>合併成一個根號</span>並相乘：",
                            katexDisplay: "$$\\sqrt{\\frac{4}{7} \\times \\frac{14}{5}}$$",
                        },
                        {
                            title: "步驟三：根號內約分",
                            instruction: "約分： $7$ 和 $14$ 約掉（剩 $1$ 和 $2$）：",
                            katexDisplay: "$$\\sqrt{\\frac{4}{\\cancel{7}_1} \\times \\frac{\\cancel{14}^2}{5}} = \\sqrt{\\frac{4 \\times 2}{5}}$$",
                        },
                        {
                            title: "步驟四：根號內計算",
                            instruction: "計算根號內的乘法：",
                            katexDisplay: "$$\\sqrt{\\frac{8}{5}}$$",
                        },
                        {
                            title: "步驟五：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$\\frac{\\sqrt{8}}{\\sqrt{5}}$$",
                        },
                        {
                            title: "步驟六：化簡分子",
                            instruction: "將 $\\sqrt{8}$ 化為最簡根式： $\\sqrt{8} = \\sqrt{4 \\times 2} = 2\\sqrt{2}$。",
                            katexDisplay: "$$\\frac{2\\sqrt{2}}{\\sqrt{5}}$$",
                        },
                        {
                            title: "步驟七：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{5}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{5}$</span>。",
                            katexDisplay: "$$\\frac{2\\sqrt{2}}{\\sqrt{5}} = \\frac{2\\sqrt{2} \\times \\sqrt{5}}{\\sqrt{5} \\times \\sqrt{5}}$$",
                        },
                        {
                            title: "步驟八：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$2\\sqrt{2} \\times \\sqrt{5} = 2\\sqrt{10}$",
                            solutionDen: "$\\sqrt{5} \\times \\sqrt{5} = 5$",
                        },
                        {
                            title: "步驟九：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來，得到答案：",
                            katexDisplay: "$$\\frac{2\\sqrt{10}}{5}$$",
                        }
                    ]
                },
                { // 第 11 題
                    problemKatex: "$$\\sqrt{\\frac{1}{8}} \\div \\sqrt{\\frac{9}{5}}$$",
                    steps: [
                        {
                            title: "步驟一：改成乘法",
                            instruction: "除以一個數，等於<span class='highlight'>乘上它的倒數</span>：",
                            katexDisplay: "$$\\sqrt{\\frac{1}{8}} \\times \\sqrt{\\frac{5}{9}}$$",
                        },
                        {
                            title: "步驟二：合併為一個根號",
                            instruction: "將兩個根號<span class='highlight'>合併成一個根號</span>並相乘：",
                            katexDisplay: "$$\\sqrt{\\frac{1 \\times 5}{8 \\times 9}} = \\sqrt{\\frac{5}{72}}$$",
                        },
                        {
                            title: "步驟三：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$\\frac{\\sqrt{5}}{\\sqrt{72}}$$",
                        },
                        {
                            title: "步驟四：化簡分母",
                            instruction: "將 $\\sqrt{72}$ 化為最簡根式： $\\sqrt{72} = \\sqrt{36 \\times 2} = 6\\sqrt{2}$。",
                            katexDisplay: "$$\\frac{\\sqrt{5}}{6\\sqrt{2}}$$",
                        },
                        {
                            title: "步驟五：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{2}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{2}$</span>。",
                            katexDisplay: "$$\\frac{\\sqrt{5}}{6\\sqrt{2}} = \\frac{\\sqrt{5} \\times \\sqrt{2}}{6\\sqrt{2} \\times \\sqrt{2}}$$",
                        },
                        {
                            title: "步驟六：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$\\sqrt{5} \\times \\sqrt{2} = \\sqrt{10}$",
                            solutionDen: "$6\\sqrt{2} \\times \\sqrt{2} = 6 \\times 2 = 12$",
                        },
                        {
                            title: "步驟七：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來，得到答案：",
                            katexDisplay: "$$\\frac{\\sqrt{10}}{12}$$",
                        }
                    ]
                },
                { // 第 12 題
                    problemKatex: "$$\\sqrt{\\frac{4}{5}} \\div \\sqrt{\\frac{4}{7}}$$",
                    steps: [
                        {
                            title: "步驟一：改成乘法",
                            instruction: "除以一個數，等於<span class='highlight'>乘上它的倒數</span>：",
                            katexDisplay: "$$\\sqrt{\\frac{4}{5}} \\times \\sqrt{\\frac{7}{4}}$$",
                        },
                        {
                            title: "步驟二：合併為一個根號",
                            instruction: "將兩個根號<span class='highlight'>合併成一個根號</span>並相乘：",
                            katexDisplay: "$$\\sqrt{\\frac{4}{5} \\times \\frac{7}{4}}$$",
                        },
                        {
                            title: "步驟三：根號內約分",
                            instruction: "約分： 分子和分母的 $4$ 直接約掉：",
                            katexDisplay: "$$\\sqrt{\\frac{\\cancel{4}}{5} \\times \\frac{7}{\\cancel{4}}} = \\sqrt{\\frac{7}{5}}$$",
                        },
                        {
                            title: "步驟四：拆開根號",
                            instruction: "利用 $\\sqrt{\\frac{a}{b}} = \\frac{\\sqrt{a}}{\\sqrt{b}}$ 將根號拆開：",
                            katexDisplay: "$$\\frac{\\sqrt{7}}{\\sqrt{5}}$$",
                        },
                        {
                            title: "步驟五：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{5}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{5}$</span>。",
                            katexDisplay: "$$\\frac{\\sqrt{7}}{\\sqrt{5}} = \\frac{\\sqrt{7} \\times \\sqrt{5}}{\\sqrt{5} \\times \\sqrt{5}}$$",
                        },
                        {
                            title: "步驟六：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$\\sqrt{7} \\times \\sqrt{5} = \\sqrt{35}$",
                            solutionDen: "$\\sqrt{5} \\times \\sqrt{5} = 5$",
                        },
                        {
                            title: "步驟七：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來，得到答案：",
                            katexDisplay: "$$\\frac{\\sqrt{35}}{5}$$",
                        }
                    ]
                },
                { // 第 13 題
                    problemKatex: "$$-\\frac{\\sqrt{4}}{\\sqrt{3}} \\div \\frac{\\sqrt{8}}{\\sqrt{9}}$$",
                    steps: [
                        {
                            title: "步驟一：判斷正負",
                            instruction: "負數除以正數，答案是<span class='highlight'>負數</span>。",
                            katexDisplay: "$$-\\left(\\frac{\\sqrt{4}}{\\sqrt{3}} \\div \\frac{\\sqrt{8}}{\\sqrt{9}}\\right)$$",
                        },
                        {
                            title: "步驟二：改成乘法",
                            instruction: "除以一個數，等於<span class='highlight'>乘上它的倒數</span>：",
                            katexDisplay: "$$-\\left(\\frac{\\sqrt{4}}{\\sqrt{3}} \\times \\frac{\\sqrt{9}}{\\sqrt{8}}\\right)$$",
                        },
                        {
                            title: "步驟三：化簡根號",
                            instruction: "先將可以化簡的根號都化簡：<br> $\\sqrt{4} = 2$<br> $\\sqrt{9} = 3$<br> $\\sqrt{8} = 2\\sqrt{2}$",
                            katexDisplay: "$$-\\left(\\frac{2}{\\sqrt{3}} \\times \\frac{3}{2\\sqrt{2}}\\right)$$",
                        },
                        {
                            title: "步驟四：約分",
                            instruction: "將分子和分母的 $2$ 約掉：",
                            katexDisplay: "$$-\\left(\\frac{\\cancel{2}}{\\sqrt{3}} \\times \\frac{3}{\\cancel{2}\\sqrt{2}}\\right) = -\\frac{3}{\\sqrt{3} \\times \\sqrt{2}}$$",
                        },
                        {
                            title: "步驟五：合併分母",
                            instruction: "計算分母的乘法：",
                            katexDisplay: "$$-\\frac{3}{\\sqrt{6}}$$",
                        },
                        {
                            title: "步驟六：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{6}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{6}$</span>。",
                            katexDisplay: "$$-\\frac{3}{\\sqrt{6}} = -\\frac{3 \\times \\sqrt{6}}{\\sqrt{6} \\times \\sqrt{6}} = -\\frac{3\\sqrt{6}}{6}$$",
                        },
                        {
                            title: "步驟七：再次約分",
                            instruction: "將分數約到最簡，分子分母<span class='highlight'>同除以 3</span>：",
                            katexDisplay: "$$-\\frac{\\cancel{3}\\sqrt{6}}{\\cancel{6}_2} = -\\frac{\\sqrt{6}}{2}$$",
                        }
                    ]
                },
                { // 第 14 題
                    problemKatex: "$$-\\frac{1}{\\sqrt{9}} \\div \\left(-\\frac{\\sqrt{2}}{\\sqrt{5}}\\right)$$",
                    steps: [
                        {
                            title: "步驟一：判斷正負",
                            instruction: "負數除以負數，答案是<span class='highlight'>正數</span>。",
                            katexDisplay: "$$\\frac{1}{\\sqrt{9}} \\div \\frac{\\sqrt{2}}{\\sqrt{5}}$$",
                        },
                        {
                            title: "步驟二：化簡根號",
                            instruction: "先將可以化簡的 $\\sqrt{9} = 3$ 化簡：",
                            katexDisplay: "$$\\frac{1}{3} \\div \\frac{\\sqrt{2}}{\\sqrt{5}}$$",
                        },
                        {
                            title: "步驟三：改成乘法",
                            instruction: "除以一個數，等於<span class='highlight'>乘上它的倒數</span>：",
                            katexDisplay: "$$\\frac{1}{3} \\times \\frac{\\sqrt{5}}{\\sqrt{2}}$$",
                        },
                        {
                            title: "步驟四：計算乘法",
                            instruction: "計算分子和分母的乘法：",
                            katexDisplay: "$$\\frac{\\sqrt{5}}{3\\sqrt{2}}$$",
                        },
                        {
                            title: "步驟五：有理化",
                            instruction: "為了讓<span class='highlight'>分母的 $\\sqrt{2}$ 消失</span>，分子和分母<span class='highlight'>同時乘以 $\\sqrt{2}$</span>。",
                            katexDisplay: "$$\\frac{\\sqrt{5}}{3\\sqrt{2}} = \\frac{\\sqrt{5} \\times \\sqrt{2}}{3\\sqrt{2} \\times \\sqrt{2}}$$",
                        },
                        {
                            title: "步驟六：計算新分子與分母",
                            instruction: "我們<span class='highlight'>分別計算</span>新的分子與分母：",
                            solutionNum: "$\\sqrt{5} \\times \\sqrt{2} = \\sqrt{10}$",
                            solutionDen: "$3\\sqrt{2} \\times \\sqrt{2} = 3 \\times 2 = 6$",
                        },
                        {
                            title: "步驟七：組合答案",
                            instruction: "最後，我們把算出來的新分子和新分母組合起來，得到答案：",
                            katexDisplay: "$$\\frac{\\sqrt{10}}{6}$$",
                        }
                    ]
                }
            ];

            // --- 獲取元素 ---
            const navContainer = document.getElementById('nav-container');
            const problemArea = document.getElementById('problem-area');
            const stepsContainer = document.getElementById('steps-container');
            const completionMessage = document.getElementById('completion-message');
            const completionBtn = document.getElementById('completion-action-btn');
            const navButtons = document.querySelectorAll('.nav-btn');

            let currentQuestionIndex = 0;
            let currentStepIndex = 0;

            // --- 函數 ---

            function renderAllKatex() {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\(', right: '\\)', display: false},
                        {left: '\\[', right: '\\]', display: true}
                    ],
                    throwOnError: false
                });
            }
            
            // 載入指定題目
            function loadQuestion(questionIndex) {
                currentQuestionIndex = questionIndex;
                currentStepIndex = 0;
                
                // 切換題目時，滾動到頁面頂端
                window.scrollTo({ top: 0, behavior: 'smooth' });

                // 更新導覽列按鈕樣式
                navButtons.forEach((btn, index) => {
                    if (index === questionIndex) {
                        btn.classList.add('nav-btn-active');
                    } else {
                        btn.classList.remove('nav-btn-active');
                    }
                });

                // 載入題目
                const question = questions[currentQuestionIndex];
                problemArea.innerHTML = question.problemKatex;

                // 清空舊步驟並隱藏完成訊息
                stepsContainer.innerHTML = '';
                completionMessage.classList.add('step-hidden');

                // 載入第一個步驟
                loadStep(0);
                
                // 重新渲染 KaTeX
                renderAllKatex();
            }

            // 載入指定步驟
            function loadStep(stepIndex) {
                currentStepIndex = stepIndex;
                const question = questions[currentQuestionIndex];
                const step = question.steps[stepIndex];

                // 如果沒有下一個步驟，顯示完成訊息
                if (!step) {
                    completionMessage.classList.remove('step-hidden');
                    
                    // 根據是否為最後一題，決定按鈕文字和功能
                    if (currentQuestionIndex < questions.length - 1) {
                        completionBtn.textContent = '換下一題';
                        completionBtn.dataset.nextQuestionIndex = currentQuestionIndex + 1;
                    } else {
                        completionBtn.textContent = '回到第一題';
                        completionBtn.dataset.nextQuestionIndex = 0;
                    }
                    
                    completionMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }

                const totalSteps = question.steps.length;
                const isLastStep = stepIndex === totalSteps - 1;
                const btnText = isLastStep ? "完成！" : "下一步";
                const btnClass = isLastStep ? "next-btn finish-btn" : "next-btn";
                const nextBtnId = `next-btn-${stepIndex}`;

                // 組合步驟 HTML
                let stepHtml = `
                    <div id="step-${stepIndex}" class="step-container">
                        <h2 class="step-title">${step.title}</h2>
                        <div class="step-progress">第 ${stepIndex + 1} 步 / 共 ${totalSteps} 步</div>
                        <p class="step-instruction">${step.instruction}</p>
                `;

                // 根據步驟類型加入不同的顯示
                if (step.katexDisplay) {
                    stepHtml += `<div class="katex-display-area" style="font-size: 1.8rem;">${step.katexDisplay}</div>`;
                }
                
                if (step.solutionNum && step.solutionDen) {
                    stepHtml += `
                        <p class="step-instruction mt-4 font-semibold text-slate-700">計算新分子：</p>
                        <div class="solution-text pt-0 mt-0">${step.solutionNum}</div>
                        <p class="step-instruction mt-4 font-semibold text-slate-700">計算新分母：</p>
                        <div class="solution-text pt-0 mt-0">${step.solutionDen}</div>
                    `;
                }

                stepHtml += `
                        <div class="text-center mt-8">
                            <button id="${nextBtnId}" class="${btnClass}">${btnText}</button>
                        </div>
                    </div>
                `; 

                // 插入 HTML
                stepsContainer.insertAdjacentHTML('beforeend', stepHtml);
                
                // 步驟一 (index 0) 載入時不滾動，之後的步驟才滾動
                if (stepIndex > 0) {
                    const newStepElement = document.getElementById(`step-${stepIndex}`);
                    newStepElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }

                // 重新渲染 KaTeX
                renderAllKatex();

                // 幫新按鈕加上事件監聽
                document.getElementById(nextBtnId).addEventListener('click', (e) => {
                    e.target.disabled = true; // 按過就禁用
                    loadStep(stepIndex + 1); // 載入下一步
                });
            }

            // 重置/切換題目
            function handleCompletionAction() {
                const nextIndex = parseInt(completionBtn.dataset.nextQuestionIndex, 10);
                loadQuestion(nextIndex);
            }

            // --- 初始設定 ---
            
            // 幫導覽列按鈕加上事件監聽
            navButtons.forEach((btn, index) => {
                btn.addEventListener('click', () => {
                    loadQuestion(index);
                });
            });

            // 幫重置按鈕加上事件監聽
            completionBtn.addEventListener('click', handleCompletionAction);

            // 頁面載入時，自動載入第一題
            loadQuestion(0);
        });
    </script>
</body>
</html>



