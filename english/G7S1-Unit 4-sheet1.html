<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- æ¨™é¡Œå·²æ›´æ–° -->
    <title>Unit 4 Grammar Focus1(è©¢å•æ˜ŸæœŸå¹¾? )</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #f0f9ff; /* light blue background */
        }
        .exercise-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 24px;
            margin-bottom: 24px;
            transition: box-shadow 0.3s ease;
        }
        .exercise-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        .example-box {
            background-color: #f8faff;
            border: 1px solid #dbeafe;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
            font-family: 'Noto Sans TC', sans-serif;
            line-height: 1.8;
            color: #1e3a8a;
        }
        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            padding: 12px;
            background-color: #f1f5f9;
            border-radius: 8px;
            min-height: 50px;
        }
        .drop-zone {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            padding: 12px;
            background-color: #ffffff;
            border: 2px dashed #94a3b8;
            border-radius: 8px;
            min-height: 50px;
            margin-top: 12px;
            transition: all 0.3s ease;
        }
        .word-item {
            padding: 8px 16px;
            background-color: #e0f2fe;
            border: 1px solid #7dd3fc;
            color: #075985;
            border-radius: 9999px; /* pill shape */
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            font-weight: 600;
        }
        .word-item:hover {
            background-color: #bae6fd;
            transform: scale(1.05);
        }
        .speaker-icon {
            cursor: pointer;
            display: inline-block;
            margin-left: 8px;
            color: #3b82f6;
            font-size: 1.2em;
            vertical-align: middle;
        }
        .speaker-icon:hover {
            color: #2563eb;
        }
        #tooltip {
            position: absolute;
            display: none;
            background-color: #1f2937;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.9em;
            pointer-events: none; /* So it doesn't interfere with mouse events */
            z-index: 100;
        }
        .drop-zone.correct {
            border-color: #22c55e;
            background-color: #f0fdf4;
        }
        .drop-zone.incorrect {
            border-color: #ef4444;
            background-color: #fef2f2;
        }
        .question-prompt {
             font-size: 1.1em;
             font-weight: 600;
             color: #1f2937;
        }
        .question-text {
            font-size: 1.0em;
            color: #4b5563;
        }

        @keyframes card-correct-glow {
            0% { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
            50% { box-shadow: 0 8px 30px rgba(34, 197, 94, 0.4); }
            100% { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
        }

        .card-glow-animation {
            animation: card-correct-glow 1s ease-out;
        }

        /* --- æ–°å¢çš„é…å°éŠæˆ²æ¨£å¼ --- */
        .match-source-item {
            padding: 8px 16px;
            background-color: #e0e7ff; /* light indigo */
            border: 1px solid #a5b4fc;
            color: #3730a3;
            border-radius: 9999px;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            font-weight: 600;
        }
        .match-source-item:hover {
            background-color: #c7d2fe;
            transform: scale(1.05);
        }
        .match-source-item.selected {
            background-color: #3730a3;
            color: white;
            border-color: #3730a3;
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(55, 48, 163, 0.3);
        }
        .match-source-item.used {
            opacity: 0.3;
            pointer-events: none;
            background-color: #eef2ff;
        }
        .match-target-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px;
            background-color: #f8faff;
            border: 1px solid #dbeafe;
            border-radius: 8px;
        }
        .match-target-text {
            font-size: 1.1em;
            font-weight: 600;
            color: #1e3a8a;
            margin-bottom: 8px;
        }
        .match-slot {
            width: 100%;
            height: 40px;
            background-color: #ffffff;
            border: 2px dashed #94a3b8;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9em;
            color: #3730a3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            padding: 0 4px;
        }
        .match-slot.filled {
            border-style: solid;
            border-color: #a5b4fc;
            background-color: #e0e7ff;
        }
        .match-slot:hover {
            background-color: #f1f5f9;
        }
        .match-slot.correct {
            border-color: #22c55e;
            background-color: #f0fdf4;
            color: #15803d;
        }
        .match-slot.incorrect {
            border-color: #ef4444;
            background-color: #fef2f2;
            color: #b91c1c;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div id="tooltip"></div>

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-8">
            <!-- æ¨™é¡Œå·²æ›´æ–° -->
            <h1 class="text-3xl sm:text-4xl font-bold text-blue-800">Unit 4 Grammar Focus1(è©¢å•æ˜ŸæœŸå¹¾? )</h1>
        </header>

        <!-- +++ æ–°å¢çš„é…å°éŠæˆ² +++ -->
        <div class="matching-game-section exercise-card mb-8">
            <h2 class="text-2xl font-bold text-blue-700 mb-4">â— ä¸­è‹±é…å°</h2>
            <p class="text-slate-600 mb-4">é»æ“Šä¸‹æ–¹è‹±æ–‡å–®å­— (å¯è½ç™¼éŸ³)ï¼Œç„¶å¾Œé»æ“Šå°æ‡‰çš„ä¸­æ–‡æ ¼å­ä¾†é…å°ã€‚</p>
            
            <!-- è‹±æ–‡é¸é … (Source) -->
            <div id="matching-source" class="flex flex-wrap gap-3 p-3 bg-indigo-50 border-2 border-indigo-200 rounded-lg">
                <!-- JS æœƒå‹•æ…‹å¡«å…¥è‹±æ–‡å–®å­— -->
            </div>

            <!-- ä¸­æ–‡é¡Œç›® (Target) -->
            <div id="matching-target" class="grid grid-cols-2 sm:grid-cols-4 gap-4 mt-6">
                <!-- JS æœƒå‹•æ…‹å¡«å…¥ä¸­æ–‡é¡Œç›® -->
            </div>

            <!-- åŠŸèƒ½æŒ‰éˆ• -->
            <div class="flex gap-3 mt-6">
                <button id="match-check-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">æª¢æŸ¥é…å°</button>
                <button id="match-reset-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">é‡æ–°é…å°</button>
            </div>
            <p id="match-feedback" class="mt-2 text-sm font-bold"></p>
        </div>
        <!-- +++ é…å°éŠæˆ²çµæŸ +++ -->


        <!-- Section 1 (åŸæœ‰çš„) -->
        <div class="exercise-section mb-8">
            <h2 class="text-2xl font-bold text-blue-700 mb-4">â— è«‹ä¾ä¾‹å¯«å‡ºå¥å­ä»£æ›</h2>
            <div class="example-box">
                <b>ä¾‹ï¼š</b>(today / Sunday) ä»Šå¤©æ˜ŸæœŸå¤©<br>
                ã€€ã€€= Today is Sunday. <br>
                ã€€ã€€= It is Sunday.
            </div>
            <div id="exercise-container-1">
                <!-- JS will inject Q1.1, Q1.2, Q2.1, Q2.2 here -->
            </div>
        </div>

        <!-- Section 2 (åŸæœ‰çš„) -->
        <div class="exercise-section">
            <h2 class="text-2xl font-bold text-blue-700 mb-4">â— è«‹ä¾ä¾‹é€ å¥</h2>
            <div class="example-box">
                <b>ä¾‹ï¼š</b>Momâ€™s birthday / Monday<br>
                <!-- *** ä¿®æ­£ *** -->
                Mom's birthday is on Monday. (ç‰¹å®šæ´»å‹•éœ€åŠ ä»‹ä¿‚è©on)
            </div>
            <div id="exercise-container-2">
                <!-- JS will inject Q3, Q4, Q5 here -->
            </div>
        </div>
    </div>

    <script>
        // --- DATA (é…å°éŠæˆ²) ---
        const matchingData = [
            { id: 1, chinese: 'æ˜ŸæœŸä¸€', english: 'Monday' },
            { id: 2, chinese: 'æ˜ŸæœŸäºŒ', english: 'Tuesday' },
            { id: 3, chinese: 'æ˜ŸæœŸä¸‰', english: 'Wednesday' },
            { id: 4, chinese: 'æ˜ŸæœŸæ—¥', english: 'Sunday' },
            { id: 5, chinese: 'æ˜ŸæœŸå››', english: 'Thursday' },
            { id: 6, chinese: 'æ˜ŸæœŸäº”', english: 'Friday' },
            { id: 7, chinese: 'æ˜ŸæœŸå…­', english: 'Saturday' },
            { id: 8, chinese: 'é€± / é€±æœ«', english: 'week / weekend' },
        ];

        // --- DATA (é‡çµ„å¥å­) ---
        const translations = {
            'Today': 'ä»Šå¤©', 'is': 'æ˜¯', 'Sunday': 'æ˜ŸæœŸå¤©', 'It': 'å®ƒ', 'Itâ€™s': 'å®ƒæ˜¯',
            'Tuesday': 'æ˜ŸæœŸäºŒ', '(today)': '(ä»Šå¤©)', 'Wednesday': 'æ˜ŸæœŸä¸‰',
            'Momâ€™s': 'åª½åª½çš„', 'birthday': 'ç”Ÿæ—¥', 'on': 'åœ¨', 'Monday': 'æ˜ŸæœŸä¸€',
            'Fatherâ€™s Day': 'çˆ¶è¦ªç¯€', 'Her': 'å¥¹çš„', 'English class': 'è‹±æ–‡èª²',
            'Friday': 'æ˜ŸæœŸäº”', 'Teacherâ€™s Day': 'æ•™å¸«ç¯€', 'Thursday': 'æ˜ŸæœŸå››',
            '?': 'ï¼Ÿ', '.': 'ã€‚',
            // æ–°å¢é…å°éŠæˆ²çš„ç¿»è­¯
            'Saturday': 'æ˜ŸæœŸå…­', 'week / weekend': 'é€± / é€±æœ«'
        };

        const exercises = [
            // Section 1
            { id: 'q1a', section: 1, prompt: '1. (today / Tuesday)', question: 'è«‹é‡çµ„: = Today ...', answer: 'Today is Tuesday.', chunks: ['Today', 'is', 'Tuesday', '.'] },
            // *** ä¿®æ­£ ***
            { id: 'q1b', section: 1, prompt: '1. (today / Tuesday)', question: 'è«‹é‡çµ„: = Itâ€™s ...', answer: 'Itâ€™s Tuesday.', chunks: ['Itâ€™s', 'Tuesday', '.'] },
            { id: 'q2a', section: 1, prompt: '2. (today / Wednesday)', question: 'è«‹é‡çµ„: = Today ...', answer: 'Today is Wednesday.', chunks: ['Today', 'is', 'Wednesday', '.'] },
            { id: 'q2b', section: 1, prompt: '2. (today / Wednesday)', question: 'è«‹é‡çµ„: = Itâ€™s ...', answer: 'Itâ€™s Wednesday.', chunks: ['Itâ€™s', 'Wednesday', '.'] },
            
            // Section 2
            { id: 'q3', section: 2, prompt: '1. Fatherâ€™s Day / Wednesday', question: 'è«‹é‡çµ„å¥å­:', answer: 'Fatherâ€™s Day is on Wednesday.', chunks: ['Fatherâ€™s Day', 'is', 'on', 'Wednesday', '.'] },
            { id: 'q4', section: 2, prompt: '2. English class / Friday', question: 'è«‹é‡çµ„å¥å­ (æç¤º: Her):', answer: 'Her English class is on Friday.', chunks: ['Her', 'English class', 'is', 'on', 'Friday', '.'] },
            { id: 'q5', section: 2, prompt: '3. Teacherâ€™s Day / Thursday', question: 'è«‹é‡çµ„å¥å­:', answer: 'Teacherâ€™s Day is on Thursday.', chunks: ['Teacherâ€™s Day', 'is', 'on', 'Thursday', '.'] }
        ];


        // --- CORE FUNCTIONS ---
        const synth = window.speechSynthesis;
        function speak(text) {
            synth.cancel();
            if (text !== '') {
                const utterThis = new SpeechSynthesisUtterance(text.replace(/[.?]/g, '').replace('/', 'and'));
                utterThis.lang = 'en-US';
                utterThis.rate = 0.9;
                synth.speak(utterThis);
            }
        }
        
        function createSpeakerIcon(textToSpeak) {
            const safeText = textToSpeak.replace(/<[^>]*>/g, '').replace(/"/g, '&quot;');
            return `<span class="speaker-icon" data-speak="${safeText}">ğŸ”Š</span>`;
        }

        // --- æ‰“äº‚é™£åˆ— ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- æ–°çš„é…å°éŠæˆ²é‚è¼¯ ---
        let selectedMatchItem = null;

        function initializeMatchingGame() {
            const sourceContainer = document.getElementById('matching-source');
            const targetContainer = document.getElementById('matching-target');
            
            sourceContainer.innerHTML = '';
            targetContainer.innerHTML = '';

            // 1. å»ºç«‹è‹±æ–‡é¸é … (æ‰“äº‚)
            const shuffledEnglish = shuffleArray([...matchingData]);
            shuffledEnglish.forEach(item => {
                const el = document.createElement('div');
                el.className = 'match-source-item';
                el.textContent = item.english;
                el.dataset.matchId = item.id;
                el.dataset.speakText = item.english;
                sourceContainer.appendChild(el);
            });

            // 2. å»ºç«‹ä¸­æ–‡é¡Œç›®
            matchingData.forEach(item => {
                const itemEl = document.createElement('div');
                itemEl.className = 'match-target-item';
                itemEl.innerHTML = `
                    <div class="match-target-text">${item.chinese}</div>
                    <div class="match-slot" data-match-id="${item.id}"></div>
                `;
                targetContainer.appendChild(itemEl);
            });

            // 3. ç¶å®šäº‹ä»¶
            addMatchingGameListeners();
        }

        function addMatchingGameListeners() {
            const sourceContainer = document.getElementById('matching-source');
            const targetContainer = document.getElementById('matching-target');
            const checkBtn = document.getElementById('match-check-btn');
            const resetBtn = document.getElementById('match-reset-btn');
            const feedbackEl = document.getElementById('match-feedback');

            // é»æ“Šè‹±æ–‡é¸é …
            sourceContainer.addEventListener('click', e => {
                if (e.target.classList.contains('match-source-item') && !e.target.classList.contains('used')) {
                    speak(e.target.dataset.speakText);
                    
                    if (selectedMatchItem === e.target) {
                        // å–æ¶ˆé¸å–
                        selectedMatchItem.classList.remove('selected');
                        selectedMatchItem = null;
                    } else {
                        // é¸å–æ–°çš„
                        if (selectedMatchItem) {
                            selectedMatchItem.classList.remove('selected');
                        }
                        selectedMatchItem = e.target;
                        selectedMatchItem.classList.add('selected');
                    }
                }
            });

            // é»æ“Šä¸­æ–‡æ ¼å­
            targetContainer.addEventListener('click', e => {
                if (e.target.classList.contains('match-slot')) {
                    const slot = e.target;

                    // CASE 1: é»æ“Šå·²å¡«æ»¿çš„æ ¼å­ (é‡ç½®è©²æ ¼)
                    if (slot.classList.contains('filled')) {
                        const placedId = slot.dataset.placedId;
                        const sourceItem = sourceContainer.querySelector(`.match-source-item[data-match-id="${placedId}"]`);
                        if (sourceItem) {
                            sourceItem.classList.remove('used');
                        }
                        slot.textContent = '';
                        slot.classList.remove('filled', 'correct', 'incorrect');
                        delete slot.dataset.placedId;
                        feedbackEl.textContent = '';
                        if(selectedMatchItem) {
                            selectedMatchItem.classList.remove('selected');
                            selectedMatchItem = null;
                        }
                        return; // å®Œæˆé‡ç½®
                    }

                    // CASE 2: é»æ“Šç©ºæ ¼ (ä¸”å·²é¸å–è‹±æ–‡)
                    if (selectedMatchItem) {
                        slot.textContent = selectedMatchItem.textContent;
                        slot.dataset.placedId = selectedMatchItem.dataset.matchId;
                        slot.classList.add('filled');

                        selectedMatchItem.classList.add('used');
                        selectedMatchItem.classList.remove('selected');
                        selectedMatchItem = null;
                        feedbackEl.textContent = '';
                    }
                }
            });

            // æª¢æŸ¥ç­”æ¡ˆ
            checkBtn.addEventListener('click', () => {
                const slots = targetContainer.querySelectorAll('.match-slot');
                let allCorrect = true;
                let allFilled = true;

                slots.forEach(slot => {
                    const correctId = slot.dataset.matchId;
                    const placedId = slot.dataset.placedId;

                    if (!placedId) {
                        allFilled = false;
                        allCorrect = false;
                        return;
                    }

                    if (correctId === placedId) {
                        slot.classList.add('correct');
                        slot.classList.remove('incorrect');
                    } else {
                        slot.classList.add('incorrect');
                        slot.classList.remove('correct');
                        allCorrect = false;
                    }
                });

                if (allCorrect) {
                    feedbackEl.textContent = 'ğŸ‰ å…¨éƒ¨ç­”å°äº†ï¼Œå¤ªæ£’äº†ï¼';
                    feedbackEl.className = 'mt-2 text-sm font-bold text-green-600';
                } else if (!allFilled) {
                    feedbackEl.textContent = 'ğŸ¤” é‚„æœ‰æ ¼å­æ²’å¡«å–”ï¼';
                    feedbackEl.className = 'mt-2 text-sm font-bold text-yellow-600';
                } else {
                    feedbackEl.textContent = 'ğŸ¤” æœ‰äº›éŒ¯èª¤å–”ï¼Œå†æª¢æŸ¥çœ‹çœ‹ï¼';
                    feedbackEl.className = 'mt-2 text-sm font-bold text-red-600';
                }
            });

            // é‡æ–°é…å°
            resetBtn.addEventListener('click', () => {
                initializeMatchingGame(); // é‡æ–°åˆå§‹åŒ–éŠæˆ²
                feedbackEl.textContent = '';
                selectedMatchItem = null;
            });
        }
        
        // --- INITIALIZATION (ç¶²é è¼‰å…¥) ---
        document.addEventListener('DOMContentLoaded', () => {
            // --- å•Ÿå‹•é…å°éŠæˆ² ---
            initializeMatchingGame();

            // --- è™•ç†åŸæœ‰çš„é‡çµ„å¥å­ ---
            const container1 = document.getElementById('exercise-container-1');
            const container2 = document.getElementById('exercise-container-2');

            exercises.forEach((ex, index) => {
                const card = document.createElement('div');
                card.className = 'exercise-card';
                card.id = `exercise-${ex.id}`;

                const words = ex.chunks;
                const contentHTML = `
                    <div class="flex items-center mb-2">
                        <div class="question-prompt">${ex.prompt}</div>
                        ${createSpeakerIcon(ex.prompt.replace(/\//g, ''))}
                    </div>
                    <p class="question-text mb-3">${ex.question}</p>
                    <div class="word-bank mt-4">
                        ${[...words].sort(() => Math.random() - 0.5).map((word, idx) => `<div class="word-item" data-word-id="${ex.id}-${idx}">${word}</div>`).join('')}
                    </div>
                    <div class="drop-zone mt-3"></div>
                    <div class="flex gap-3 mt-4">
                         <button class="check-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded" data-answer="${ex.answer}" data-id="${ex.id}">æª¢æŸ¥ç­”æ¡ˆ</button>
                         <button class="reset-btn bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded" data-id="${ex.id}">é‡æ–°ä½œç­”</button>
                         <button class="hint-btn bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded" data-speak-hint="${ex.answer}">ğŸ’¡ æç¤º (è½ç­”æ¡ˆ)</button>
                    </div>
                    <p class="feedback mt-2 text-sm font-bold"></p>
                `;
                card.innerHTML = contentHTML;
                
                if (ex.section === 1) {
                    container1.appendChild(card);
                } else {
                    container2.appendChild(card);
                }
            });

            addEventListeners();
        });

        // --- ç¶å®šé‡çµ„å¥å­çš„äº‹ä»¶ ---
        function addEventListeners() {
            // Tooltip (å…±ç”¨)
            const tooltip = document.getElementById('tooltip');
            document.body.addEventListener('mouseover', (e) => {
                if (e.target.classList.contains('word') || e.target.closest('.word-item') || e.target.closest('.match-source-item')) {
                     const wordElement = e.target.closest('.word-item') || e.target.closest('.match-source-item') || e.target;
                     const text = wordElement.textContent.trim().replace(/[.?,]/g, '');
                     const chinese = translations[text];
                    if (chinese) {
                        tooltip.textContent = chinese;
                        tooltip.style.display = 'block';
                    }
                }
            });
             document.body.addEventListener('mousemove', (e) => {
                if (tooltip.style.display === 'block') {
                    tooltip.style.left = `${e.pageX + 10}px`;
                    tooltip.style.top = `${e.pageY + 10}px`;
                }
            });
            document.body.addEventListener('mouseout', (e) => {
                if (e.target.classList.contains('word') || e.target.closest('.word-item') || e.target.closest('.match-source-item')) {
                    tooltip.style.display = 'none';
                }
            });

            // Speaker Icon & Hint Button clicks (é‡çµ„å¥å­)
            document.body.addEventListener('click', (e) => {
                if (e.target.classList.contains('speaker-icon')) {
                    e.stopPropagation();
                    const textToSpeak = e.target.dataset.speak;
                    if (textToSpeak) speak(textToSpeak);
                }
                if (e.target.classList.contains('hint-btn')) {
                    const textToSpeak = e.target.dataset.speakHint;
                    if (textToSpeak) speak(textToSpeak);
                }
            });
            
            // --- UN SCRAMBLE LOGIC (é‡çµ„å¥å­) ---
            document.body.addEventListener('click', e => {
                const target = e.target;
                if (target.classList.contains('word-item')) {
                    const card = target.closest('.exercise-card');
                    if (!card) return; // é¿å…å¹²æ“¾é…å°éŠæˆ²
                    const wordBank = card.querySelector('.word-bank');
                    const dropZone = card.querySelector('.drop-zone');
                    
                    if (target.parentElement === wordBank) {
                        speak(target.textContent);
                        dropZone.appendChild(target);
                    } else if (target.parentElement === dropZone) {
                        wordBank.appendChild(target);
                    }
                }
            });

            // Check unscramble answers (é‡çµ„å¥å­)
            document.querySelectorAll('.check-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const exId = btn.dataset.id;
                    const card = document.getElementById(`exercise-${exId}`);
                    const dropZone = card.querySelector('.drop-zone');
                    const feedbackEl = card.querySelector('.feedback');
                    const words = Array.from(dropZone.children).map(child => child.textContent);
                    
                    let userAnswer = '';
                    for (let i = 0; i < words.length; i++) {
                        // è‡ªå‹•åœ¨å–®å­—é–“æ·»åŠ ç©ºæ ¼ (é™¤éæ˜¯æ¨™é»ç¬¦è™Ÿ)
                        if (i > 0 && ![',', '.', '?'].includes(words[i]) && !words[i].startsWith('(')) {
                            userAnswer += ' ';
                        }
                        userAnswer += words[i];
                    }
                    userAnswer = userAnswer.trim();

                    const correctAnswer = btn.dataset.answer;

                    if (userAnswer === correctAnswer) {
                        feedbackEl.textContent = 'ğŸ‰ å¤ªæ£’äº†ï¼Œç­”å°äº†ï¼';
                        feedbackEl.className = 'feedback mt-2 text-sm font-bold text-green-600';
                        dropZone.classList.remove('incorrect');
                        dropZone.classList.add('correct');
                        card.classList.add('card-glow-animation');
                        setTimeout(() => card.classList.remove('card-glow-animation'), 1000);
                    } else {
                        feedbackEl.textContent = 'ğŸ¤” å†è©¦ä¸€æ¬¡çœ‹çœ‹ï¼';
                        feedbackEl.className = 'feedback mt-2 text-sm font-bold text-red-600';
                        dropZone.classList.remove('correct');
                        dropZone.classList.add('incorrect');
                    }
                });
            });
            
            // Reset unscramble questions (é‡çµ„å¥å­)
            document.querySelectorAll('.reset-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const exId = btn.dataset.id;
                    const card = document.getElementById(`exercise-${exId}`);
                    const dropZone = card.querySelector('.drop-zone');
                    const wordBank = card.querySelector('.word-bank');
                    const feedbackEl = card.querySelector('.feedback');
                    
                    // å°‡æ‰€æœ‰å–®å­—ç§»å› word-bank
                    Array.from(dropZone.children).forEach(child => wordBank.appendChild(child));
                    
                    // (å¯é¸) é‡æ–°æ‰“äº‚ word-bank ä¸­çš„é †åº
                    const items = Array.from(wordBank.children);
                    items.sort(() => Math.random() - 0.5);
                    items.forEach(item => wordBank.appendChild(item));

                    feedbackEl.textContent = '';
                    dropZone.classList.remove('correct', 'incorrect');
                });
            });
        }
    </script>
</body>
</html>