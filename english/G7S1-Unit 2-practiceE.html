<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNIT2-ç¿’ä½œE</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter for English, Noto Sans TC for Chinese -->     
    <link rel="icon" href="dog.png" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* è‡ªå®šç¾©æ¨£å¼ */
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
        }

        /* äº’å‹•å–®å­—æ¨£å¼ */
        .word {
            position: relative;
            cursor: pointer;
            border-bottom: 1px dotted #a8a29e; /* stone-400 */
            transition: color 0.2s;
        }

        .word:hover {
            color: #d97706; /* amber-600 */
        }

        /* ä¸­æ–‡ç¿»è­¯æç¤ºæ¡† (Tooltip) */
        .word .tooltip {
            visibility: hidden;
            width: max-content;
            background-color: #1f2937; /* gray-800 */
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 10px;
            position: absolute;
            z-index: 10;
            bottom: 130%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none; /* é¿å…æç¤ºæ¡†å¹²æ“¾æ»‘é¼ äº‹ä»¶ */
        }

        .word:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body class="bg-amber-50 flex items-center justify-center min-h-screen p-4">

    <!-- æ¸¬é©—ä¸»å®¹å™¨ -->
    <div id="quiz-container" class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg w-full max-w-3xl">
        <h1 class="text-2xl sm:text-3xl font-bold text-stone-800 text-center mb-4">ä¸ƒä¸Šè‹±æ–‡U2-ç¿’ä½œE</h1>
        
        <!-- é€²åº¦æ¢ -->
        <div class="w-full bg-stone-200 rounded-full h-2.5 mb-6">
            <div id="progress-bar" class="bg-amber-500 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
        </div>
        
        <!-- é¡Œç›®å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆæ–¼æ­¤ -->
        <div id="questions-wrapper"></div>

        <!-- åŠŸèƒ½æŒ‰éˆ•èˆ‡åˆ†æ•¸é¡¯ç¤ºå€ -->
        <div id="controls" class="mt-8 text-center">
            <!-- æŒ‰éˆ•å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
        </div>
        <div id="score-display" class="mt-6 text-center hidden"></div>
    </div>

    <!-- æç¤ºè¨Šæ¯ Modal -->
    <div id="alert-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-20">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm text-center">
            <p id="alert-message" class="text-lg text-gray-800 mb-4"></p>
            <button id="close-alert-btn" class="bg-amber-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-amber-600 transition-colors">çŸ¥é“äº†</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- è³‡æ–™å®šç¾©å€ ---
            const translations = {
                "what's": "ä»€éº¼æ˜¯", "what": "ä»€éº¼", "the": "é€™å€‹", "today": "ä»Šå¤©", "it's": "å®ƒæ˜¯", "may": "äº”æœˆ",
                "time": "æ™‚é–“", "day": "å¤©", "month": "æœˆä»½", "date": "æ—¥æœŸ", "when": "ä½•æ™‚", "is": "æ˜¯", "her": "å¥¹çš„",
                "school": "å­¸æ ¡", "november": "åä¸€æœˆ", "on": "åœ¨", "in": "åœ¨...è£¡é¢", "your": "ä½ çš„", "birthday": "ç”Ÿæ—¥",
                "oh": "å“¦", "also": "ä¹Ÿ", "new": "æ–°çš„", "year's": "å¹´çš„", "at": "åœ¨", "nine": "ä¹", "thirty": "ä¸‰å",
                "january": "ä¸€æœˆ", "first": "ç¬¬ä¸€", "december": "åäºŒæœˆ", "this": "é€™å€‹", "boy": "ç”·å­©", "has": "æœ‰",
                "beautiful": "ç¾éº—çš„", "eyes": "çœ¼ç›", "and": "å’Œ", "long": "é•·çš„", "hair": "é ­é«®", "i": "æˆ‘",
                "like": "å–œæ­¡", "him": "ä»–(å—æ ¼)", "very": "éå¸¸", "much": "å¾ˆå¤š", "he": "ä»–(ä¸»æ ¼)", "his": "ä»–çš„", "he's": "ä»–æ˜¯",
                "hi": "å—¨", "i'm": "æˆ‘æ˜¯", "nice": "é«˜èˆˆçš„", "to": "å»", "meet": "é‡è¦‹", "you": "ä½ ", "too": "ä¹Ÿ", "see": "çœ‹åˆ°",
                "you're": "ä½ æ˜¯", "welcome": "ä¸å®¢æ°£", "excuse": "è«‹å•", "me": "æˆ‘", "are": "æ˜¯", "mr.": "å…ˆç”Ÿ", "walker": "æ²ƒå…‹",
                "yes": "æ˜¯çš„", "larry": "è³´ç‘", "no": "ä¸æ˜¯", "not": "ä¸", "friend": "æœ‹å‹", "who's": "èª°æ˜¯", "that": "é‚£å€‹",
                "girl": "å¥³å­©", "she": "å¥¹", "really": "çœŸçš„", "tall": "é«˜çš„", "a": "ä¸€å€‹", "happy": "å¿«æ¨‚çš„", "she's": "å¥¹æ˜¯",
                "ariel": "æ„›éº—å…’", "our": "æˆ‘å€‘çš„", "classmate": "åŒå­¸", "eric's": "è‰¾ç‘å…‹çš„", "aunt": "é˜¿å§¨", "writer": "ä½œå®¶",
                "doctor": "é†«ç”Ÿ", "housewife": "å®¶åº­ä¸»å©¦", "how": "å¦‚ä½•", "old": "å¹´è€çš„", "alice": "æ„›éº—çµ²", "brad": "å¸ƒèŠå¾·",
                "they": "ä»–å€‘", "my": "æˆ‘çš„", "family": "å®¶åº­", "ten": "å", "twelve": "åäºŒ", "cook": "å»šå¸«", "nurse": "è­·å£«",
                "they're": "ä»–å€‘æ˜¯", "erasers": "æ©¡çš®æ“¦", "where": "åœ¨å“ªè£¡", "those": "é‚£äº›", "these": "é€™äº›", "pens": "ç­†(è¤‡æ•¸)", 
                "aren't": "ä¸æ˜¯", "for": "çµ¦/ç‚ºäº†", "desk": "æ›¸æ¡Œ", "where's": "åœ¨å“ªè£¡", "notebook": "ç­†è¨˜æœ¬", "from": "å¾", 
                "uncle": "å”å”/ä¼¯ä¼¯", "under": "åœ¨...ä¸‹é¢", "chair": "æ¤…å­", "enough": "è¶³å¤ çš„", "one": "ä¸€", "person": "äºº", 
                "favorite": "æœ€å–œæ­¡çš„", "color": "é¡è‰²", "gray": "ç°è‰²", "purple": "ç´«è‰²", "table": "æ¡Œå­", "isn't": "ä¸æ˜¯", 
                "red": "ç´…è‰²", "watch": "æ‰‹éŒ¶", "special": "ç‰¹åˆ¥çš„", "parents": "çˆ¶æ¯", "home": "å®¶", "we": "æˆ‘å€‘", "park": "å…¬åœ’", 
                "house": "æˆ¿å­", "maybe": "ä¹Ÿè¨±", "kitchen": "å»šæˆ¿"
            };

            const quizData = [
                {
                    question: "A: __________ B: They're erasers.",
                    options: ["Where are they?", "What are those?", "How old are they?"],
                    answer: "B",
                    hint: "å›ç­”æ˜¯ç‰©å“ (erasers)ï¼Œæ‰€ä»¥å•é¡Œæ‡‰è©²æ˜¯åœ¨å•ã€Œé‚£æ˜¯ä»€éº¼ï¼Ÿã€ã€‚"
                },
                {
                    question: "A: Are these your pens? B: __________",
                    options: ["No, they aren't.", "Yes, they are for you.", "No, they're not on the desk."],
                    answer: "A",
                    hint: "ç”¨ Are... é–‹é ­çš„å•å¥ï¼Œæœ€ç›´æ¥çš„å›ç­”æ˜¯ Yes æˆ– Noã€‚"
                },
                {
                    question: "A: Where's your notebook? B: __________",
                    options: ["It's from my uncle.", "It's under the chair.", "It's enough for one person."],
                    answer: "B",
                    hint: "å•é¡Œæ˜¯ã€Œåœ¨å“ªè£¡ï¼Ÿ(Where)ã€ï¼Œæ‰€ä»¥å›ç­”æ‡‰è©²æ˜¯ä¸€å€‹åœ°é»æˆ–ä½ç½®ã€‚"
                },
                {
                    question: "A: What's your favorite color? B: __________",
                    options: ["It's gray.", "It's a purple table.", "Isn't that red watch special?"],
                    answer: "A",
                    hint: "å•é¡Œæ˜¯ã€Œä½ æœ€å–œæ­¡çš„é¡è‰²æ˜¯ä»€éº¼ï¼Ÿã€ï¼Œæ‰€ä»¥æ‡‰è©²ç›´æ¥å›ç­”ä¸€å€‹é¡è‰²ã€‚"
                },
                {
                    question: "A: Are your parents at home? B: __________",
                    options: ["Yes. We are at the park.", "Yes. They're in the house.", "No. Maybe they're in the kitchen."],
                    answer: "B",
                    hint: "é¸é … A å’Œ C çš„å›ç­”å‰å¾ŒçŸ›ç›¾ã€‚å¦‚æœçˆ¶æ¯åœ¨å®¶ (Yes)ï¼Œä»–å€‘å°±åœ¨æˆ¿å­è£¡ã€‚"
                }
            ];

            // --- ç‹€æ…‹è®Šæ•¸ ---
            let currentQuestionIndex = 0;
            let score = 0;

            // --- DOM å…ƒç´  ---
            const questionsWrapper = document.getElementById('questions-wrapper');
            const controlsContainer = document.getElementById('controls');
            const scoreDisplay = document.getElementById('score-display');
            const progressBar = document.getElementById('progress-bar');
            const quizTitle = document.querySelector('#quiz-container h1');
            const alertModal = document.getElementById('alert-modal');
            const alertMessage = document.getElementById('alert-message');
            const closeAlertBtn = document.getElementById('close-alert-btn');

            // --- åŠŸèƒ½å‡½å¼å€ ---

            /**
             * å°‡æ–‡å­—è½‰æ›ç‚ºåŒ…å«äº’å‹•å¼å–®å­—çš„ HTML
             */
            function createInteractiveText(text) {
                const parts = text.split(/([a-zA-Z'â€™]+)/);
                return parts.map(part => {
                    const cleanPart = part.toLowerCase().replace(/â€™/g, "'");
                    if (translations[cleanPart]) {
                        return `<span class="word">${part}<span class="tooltip">${translations[cleanPart]}</span></span>`;
                    }
                    return part;
                }).join('');
            }

            /**
             * ä½¿ç”¨ç€è¦½å™¨ API æœ—è®€æ–‡å­—
             */
            function speak(text) {
                if ('speechSynthesis' in window) {
                    window.speechSynthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'en-US';
                    utterance.rate = 0.9;
                    window.speechSynthesis.speak(utterance);
                } else {
                    console.error("æ­¤ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³åˆæˆåŠŸèƒ½ã€‚");
                }
            }

            /**
             * é¡¯ç¤ºæŒ‡å®šç´¢å¼•çš„é¡Œç›®
             */
            function displayQuestion(index) {
                questionsWrapper.innerHTML = '';
                controlsContainer.innerHTML = '';

                const progressPercentage = (index / quizData.length) * 100;
                progressBar.style.width = `${progressPercentage}%`;

                const q = quizData[index];
                const questionBlock = document.createElement('div');
                questionBlock.id = `q-${index}`;

                const questionText = document.createElement('p');
                questionText.className = 'text-lg text-stone-700 mb-4';
                questionText.innerHTML = `<strong>${index + 1}.</strong> ${createInteractiveText(q.question)}`;
                
                const optionsGrid = document.createElement('div');
                optionsGrid.className = 'grid grid-cols-1 sm:grid-cols-2 gap-3';
                
                q.options.forEach((option, i) => {
                    const optionChar = String.fromCharCode(65 + i);
                    const optionContainer = document.createElement('div');
                    optionContainer.className = 'flex items-center p-3 border border-stone-300 rounded-lg transition-all cursor-pointer hover:bg-amber-50';
                    
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.id = `q${index}-opt${optionChar}`;
                    radio.name = `q${index}`;
                    radio.value = optionChar;
                    radio.className = 'h-4 w-4 text-amber-600 focus:ring-amber-500 border-gray-300';

                    const label = document.createElement('label');
                    label.htmlFor = `q${index}-opt${optionChar}`;
                    label.className = 'ml-3 block text-md text-stone-900 flex-1 cursor-pointer';
                    label.innerHTML = `(${optionChar}) ${createInteractiveText(option)}`;

                    optionContainer.onclick = () => { radio.checked = true; };
                    optionContainer.appendChild(radio);
                    optionContainer.appendChild(label);
                    optionsGrid.appendChild(optionContainer);
                });

                const hintContainer = document.createElement('div');
                hintContainer.className = 'mt-4';
                const hintButton = document.createElement('button');
                hintButton.className = 'text-sm text-amber-600 hover:text-amber-800';
                hintButton.textContent = 'ğŸ’¡ æç¤º';
                const hintText = document.createElement('p');
                hintText.className = 'hint-content hidden mt-2 text-sm text-stone-600 bg-yellow-100 p-2 rounded-md';
                hintText.textContent = q.hint;
                hintButton.onclick = () => hintText.classList.toggle('hidden');
                hintContainer.appendChild(hintButton);
                hintContainer.appendChild(hintText);
                
                questionBlock.appendChild(questionText);
                questionBlock.appendChild(optionsGrid);
                questionBlock.appendChild(hintContainer);
                questionsWrapper.appendChild(questionBlock);

                const submitButton = document.createElement('button');
                submitButton.className = 'w-full sm:w-auto bg-amber-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-amber-600 transition-colors focus:outline-none focus:ring-2 focus:ring-amber-400 focus:ring-opacity-50';
                submitButton.textContent = 'æª¢æŸ¥ç­”æ¡ˆ';
                submitButton.onclick = () => checkCurrentAnswer(index);
                controlsContainer.appendChild(submitButton);
            }

            /**
             * æª¢æŸ¥ç•¶å‰é¡Œç›®çš„ç­”æ¡ˆ
             */
            function checkCurrentAnswer(index) {
                const selectedRadio = document.querySelector(`input[name="q${index}"]:checked`);

                if (!selectedRadio) {
                    alertMessage.textContent = 'è«‹å…ˆé¸æ“‡ä¸€å€‹ç­”æ¡ˆï¼';
                    alertModal.classList.remove('hidden');
                    return;
                }

                const q = quizData[index];
                const questionBlock = document.getElementById(`q-${index}`);
                questionBlock.querySelectorAll('input[type="radio"]').forEach(radio => { radio.disabled = true; });
                questionBlock.querySelectorAll('div.flex.items-center').forEach(div => { div.onclick = null; div.classList.remove('hover:bg-amber-50'); div.style.cursor = 'default'; });


                const correctOptionValue = q.answer;
                const correctLabel = document.querySelector(`label[for="q${index}-opt${correctOptionValue}"]`);
                const userLabel = selectedRadio.nextElementSibling;
                
                if (selectedRadio.value === correctOptionValue) {
                    score++;
                    userLabel.parentElement.classList.add('bg-yellow-100', 'border-yellow-400', 'ring-2', 'ring-yellow-300');
                    userLabel.innerHTML += ' <span class="text-green-600 font-bold">âœ”ï¸</span>';
                } else {
                    userLabel.parentElement.classList.add('bg-red-100', 'border-red-400', 'ring-2', 'ring-red-300');
                    userLabel.innerHTML += ' <span class="text-red-600 font-bold">âŒ</span>';
                    correctLabel.parentElement.classList.add('bg-yellow-100', 'border-yellow-400');
                }

                controlsContainer.innerHTML = '';
                const nextButton = document.createElement('button');
                nextButton.className = 'w-full sm:w-auto bg-amber-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-amber-600 transition-colors';

                if (currentQuestionIndex < quizData.length - 1) {
                    nextButton.textContent = 'ä¸‹ä¸€é¡Œ';
                    nextButton.onclick = () => {
                        currentQuestionIndex++;
                        displayQuestion(currentQuestionIndex);
                    };
                } else {
                    nextButton.textContent = 'å®Œæˆæ¸¬é©—';
                    nextButton.onclick = showFinalScore;
                }
                controlsContainer.appendChild(nextButton);
            }

            /**
             * é¡¯ç¤ºæœ€çµ‚åˆ†æ•¸
             */
            function showFinalScore() {
                progressBar.style.width = '100%';
                questionsWrapper.innerHTML = '';
                controlsContainer.innerHTML = '';
                quizTitle.textContent = 'æ¸¬é©—å®Œæˆï¼';

                scoreDisplay.innerHTML = `
                    <p class="text-xl text-stone-600">ä½ çš„æœ€çµ‚åˆ†æ•¸</p>
                    <p class="text-5xl my-4 text-stone-800">${score} / ${quizData.length}</p>
                `;
                scoreDisplay.classList.remove('hidden');

                const restartButton = document.createElement('button');
                restartButton.className = 'mt-6 w-full sm:w-auto bg-amber-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-amber-600 transition-colors';
                restartButton.textContent = 'é‡æ–°æ¸¬é©—';
                restartButton.onclick = () => window.location.reload();
                scoreDisplay.appendChild(restartButton);
            }

            // --- äº‹ä»¶ç›£è½å€ ---
            questionsWrapper.addEventListener('click', (e) => {
                if (e.target.classList.contains('word')) {
                    speak(e.target.childNodes[0].nodeValue);
                }
            });

            closeAlertBtn.addEventListener('click', () => {
                alertModal.classList.add('hidden');
            });

            // --- ç¨‹å¼é€²å…¥é» ---
            displayQuestion(currentQuestionIndex);
        });
    </script>
</body>
</html>

