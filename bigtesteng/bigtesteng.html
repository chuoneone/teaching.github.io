<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>113會考1-10</title>
    <link rel="icon" href="dog.png" type="image/png">
    <link rel="stylesheet" href="teststyle.css">
</head>
<body>

<div id="quiz-wrapper"> <!-- Outer container -->
    <div id="score-area">分數: 0 / 10</div>

    <div id="main-content"> <!-- Flex container for columns -->

        <div id="left-column"> <!-- Question, Options, Buttons -->
            <div id="question-area">
                <div id="question-number">問題 1 / 10</div>
                <div id="image-container">
                    <!-- Image -->
                </div>
                <div id="question-text">
                    <!-- Question text -->
                </div>
                <div id="options-area">
                    <!-- Options -->
                </div>
            </div>
             <div id="navigation-buttons">
                <button id="hint-btn">提示</button>
                <button id="check-btn">檢查答案</button>
                <button id="next-btn" disabled>下一題</button>
            </div>
        </div>

        <div id="right-column"> <!-- Hints and Feedback -->
            <div id="detailed-hint-area">
                <!-- Detailed hint content generated by JS -->
            </div>

            <div id="feedback-area">
                <h4 id="feedback-title"></h4>
                <span class="explanation-title">📘 解析：</span>
                <span id="feedback-explanation" class="explanation-content"></span>
            </div>
        </div>

    </div> <!-- End #main-content -->
</div> <!-- End #quiz-wrapper -->


<div id="results-area"> <!-- Results screen remains separate -->
    <h2>測驗完成！</h2>
    <p id="final-score">你的最終分數是: X / 10</p>
    <button onclick="location.reload()">重新開始測驗</button>
</div>

<!-- JavaScript remains embedded here -->
<script>
    const questions = [
         {
             questionHTML: `Look at the picture. There is <span id="q0_h1">______</span> <span id="q0_h2">under the door</span>.`,
             imageSrc: "113eng01.png", // Ensure image is in the same folder
             options: ["an envelope", "a plant", "a sign", "an umbrella"],
             answer: "A",
             highlightSelectors: ["#q0_h1", "#q0_h2"],
             hintKeywords: [
                 { word: "under", definition: "在...下面" },
                 { word: "door", definition: "門" }
             ],
             optionTranslations: ["一個信封", "一株植物", "一個標誌", "一把雨傘"],
             explanation: `看圖找答案。門下面有一張信，叫 <span class='highlight-keyword'>envelope</span>。不是植物、不是傘、不是標示牌。`
         },
         {
             questionHTML: `My <span id="q1_h1">______</span> <span id="q1_h2">hurts</span> so much that I cannot even <span id="q1_h3">turn my head</span>.`,
             imageSrc: null,
             options: ["arm", "knee", "neck", "stomach"],
             answer: "C",
             highlightSelectors: ["#q1_h1", "#q1_h2", "#q1_h3"],
              hintKeywords: [
                 { word: "hurts", definition: "疼痛" },
                 { word: "turn my head", definition: "轉我的頭" }
             ],
             optionTranslations: ["手臂", "膝蓋", "脖子", "肚子"],
             explanation: `轉頭會痛，一定是<span class='highlight-keyword'>脖子 (neck)</span>痛。`
         },
         {
             questionHTML: `Our school basketball team <span id="q2_h1">won</span> the national game last night. We are so <span id="q2_h2">______</span> them.`,
             imageSrc: null,
             options: ["popular with", "proud of", "sorry for", "worried about"],
             answer: "B",
             highlightSelectors: ["#q2_h1", "#q2_h2"],
             hintKeywords: [
                 { word: "won", definition: "贏了" },
                 { word: "national game", definition: "全國比賽" }
             ],
             optionTranslations: ["受...歡迎", "為...驕傲", "為...感到遺憾/抱歉", "擔心..."],
             explanation: `「<span class='highlight-keyword'>為他們驕傲</span>」要說 <span class='highlight-keyword'>proud of</span>。`
         },
         {
             questionHTML: `Tomorrow is Sam’s <span id="q3_h1">last day</span> in the office. Nobody knows why he <span id="q3_h2">decided to ______</span>.`,
             imageSrc: null,
             options: ["hide", "leave", "pack", "walk"],
             answer: "B",
             highlightSelectors: ["#q3_h1", "#q3_h2"],
             hintKeywords: [
                 { word: "last day", definition: "最後一天" },
                 { word: "decided", definition: "決定" }
             ],
             optionTranslations: ["躲藏", "離開", "打包", "走路"],
             explanation: `他明天最後一天上班，是要<span class='highlight-keyword'>離開 (leave)</span>。`
         },
         {
             questionHTML: `It’s not a good idea to go mountain climbing in this <span id="q4_h1">bad ______</span>. We should wait until the <span id="q4_h2">typhoon</span> goes away.`,
             imageSrc: null,
             options: ["chance", "dream", "habit", "weather"],
             answer: "D",
             highlightSelectors: ["#q4_h1", "#q4_h2"],
              hintKeywords: [
                 { word: "bad", definition: "壞的；惡劣的" },
                 { word: "mountain climbing", definition: "爬山" },
                 { word: "typhoon", definition: "颱風" }
             ],
             optionTranslations: ["機會", "夢想", "習慣", "天氣"],
             explanation: `<span class='highlight-keyword'>天氣 (weather)</span> 不好 (因有颱風)，不適合爬山。`
         },
         {
             questionHTML: `Chris loves <span id="q5_h1">walking with Anna on snowy days</span>, but Anna <span id="q5_h2">hates ______</span> very much.`,
             imageSrc: null,
             options: ["them", "so", "one", "it"],
             answer: "D",
             highlightSelectors: ["#q5_h1", "#q5_h2"],
              hintKeywords: [
                 { word: "snowy days", definition: "下雪天" },
                 { word: "hates", definition: "討厭" }
             ],
             optionTranslations: ["他們/牠們/它們 (複數)", "如此/也", "一個 (泛指)", "它 (單數/事情)"],
             explanation: `<span class='highlight-keyword'>it</span> 是指「在下雪天散步」這件事。`
         },
         {
             questionHTML: `Lora <span id="q6_h1">likes</span> to eat bananas that are already a little brown on the outside, and <span id="q6_h2">so ______ I</span>.`,
             imageSrc: null,
             options: ["am", "do", "have", "will"],
             answer: "B",
             highlightSelectors: ["#q6_h1", "#q6_h2"],
              hintKeywords: [
                 { word: "likes", definition: "喜歡 (動詞)" },
                 { word: "so ... I", definition: "我也..." }
             ],
             optionTranslations: ["是 (be動詞)", "做/的確 (助動詞)", "有 (助動詞/動詞)", "將會 (助動詞)"],
             explanation: `她喜歡 (likes)，我也喜歡，要說 <span class='highlight-keyword'>so do I</span>。`
         },
         {
             questionHTML: `Your refrigerator shouldn’t be making loud noises now, but <span id="q7_h1">if it ______ does</span>, just give me a call and I’ll come check it again.`,
             imageSrc: null,
             options: ["already", "even", "finally", "still"],
             answer: "D",
             highlightSelectors: ["#q7_h1"],
             hintKeywords: [
                 { word: "shouldn't", definition: "不應該" },
                 { word: "loud noises", definition: "大噪音" },
                 { word: "if ... does", definition: "如果...真的..." }
             ],
             optionTranslations: ["已經", "甚至", "終於", "仍然"],
             explanation: `如果冰箱<span class='highlight-keyword'>仍然 (still)</span> 有聲音，still 就是「仍然」。`
         },
         {
             questionHTML: `After <span id="q8_h1">winning money</span> in the card game, Jay decided to <span id="q8_h2">try again</span>. He felt that he might also <span id="q8_h3">be ______</span> a second time.`,
             imageSrc: null,
             options: ["famous", "interested", "lucky", "ready"],
             answer: "C",
             highlightSelectors: ["#q8_h1", "#q8_h2", "#q8_h3"],
             hintKeywords: [
                 { word: "winning money", definition: "贏錢" },
                 { word: "try again", definition: "再試一次" },
                 { word: "felt", definition: "感覺 (feel過去式)" }
             ],
             optionTranslations: ["有名的", "感興趣的", "幸運的", "準備好的"],
             explanation: `他上次贏錢，覺得自己再試一次也可能會<span class='highlight-keyword'>幸運 (lucky)</span>。`
         },
         {
             questionHTML: `The knife <span id="q9_h1">doesn’t cut very well</span>. It’s <span id="q9_h2">not as ______ as before</span>.`,
             imageSrc: null,
             options: ["bright", "heavy", "quick", "sharp"],
             answer: "D",
             highlightSelectors: ["#q9_h1", "#q9_h2"],
             hintKeywords: [
                 { word: "knife", definition: "刀子" },
                 { word: "cut well", definition: "切得好/鋒利" },
                 { word: "not as ... as before", definition: "不像以前那麼..." }
             ],
             optionTranslations: ["明亮的", "重的", "快的", "鋒利的"],
             explanation: `刀變鈍了（切不動），不再<span class='highlight-keyword'>鋒利 (sharp)</span>。`
         }
     ];

    let currentQuestionIndex = 0;
    let score = 0;
    let answerChecked = false;
    let hintUsed = false;

    const questionNumberEl = document.getElementById('question-number');
    const imageContainerEl = document.getElementById('image-container');
    const questionTextEl = document.getElementById('question-text');
    const optionsAreaEl = document.getElementById('options-area');
    const hintBtn = document.getElementById('hint-btn');
    const checkBtn = document.getElementById('check-btn');
    const nextBtn = document.getElementById('next-btn');
    const detailedHintAreaEl = document.getElementById('detailed-hint-area');
    const feedbackAreaEl = document.getElementById('feedback-area');
    const feedbackTitleEl = document.getElementById('feedback-title');
    const feedbackExplanationEl = document.getElementById('feedback-explanation');
    const scoreAreaEl = document.getElementById('score-area');
    const quizWrapperEl = document.getElementById('quiz-wrapper');
    const resultsAreaEl = document.getElementById('results-area');
    const finalScoreEl = document.getElementById('final-score');
    const rightColumnEl = document.getElementById('right-column');


    function loadQuestion() {
        answerChecked = false;
        hintUsed = false;
        const currentQuestion = questions[currentQuestionIndex];

        questionNumberEl.textContent = `問題 ${currentQuestionIndex + 1} / ${questions.length}`;
        questionTextEl.innerHTML = currentQuestion.questionHTML;

        imageContainerEl.innerHTML = '';
        if (currentQuestion.imageSrc) {
            const img = document.createElement('img');
            img.id = `q${currentQuestionIndex}_image`;
            img.src = currentQuestion.imageSrc;
            img.alt = `Question ${currentQuestionIndex + 1} Image`;
            img.onerror = function() {
                imageContainerEl.innerHTML = '<p style="color: var(--incorrect-text); font-size: 0.9em;">圖片加載失敗！請確保圖片 "' + currentQuestion.imageSrc + '" 與HTML文件在同一資料夾中。</p>';
            };
            imageContainerEl.appendChild(img);
        }

        optionsAreaEl.innerHTML = '';
        currentQuestion.options.forEach((option, index) => {
            const optionLetter = String.fromCharCode(65 + index);
            const optionId = `q${currentQuestionIndex}_opt${index}`;
            const optionDiv = document.createElement('div');
            optionDiv.className = 'option';
            const radioInput = document.createElement('input');
            radioInput.type = 'radio';
            radioInput.name = `q${currentQuestionIndex}_options`;
            radioInput.id = optionId;
            radioInput.value = optionLetter;
            const label = document.createElement('label');
            label.htmlFor = optionId;
            label.textContent = `(${optionLetter}) ${option}`;
             optionDiv.addEventListener('click', (e) => {
                 if (!answerChecked && !e.target.disabled) {
                    radioInput.checked = true;
                 }
             });
            optionDiv.appendChild(radioInput);
            optionDiv.appendChild(label);
            optionsAreaEl.appendChild(optionDiv);
        });

        detailedHintAreaEl.style.display = 'none';
        detailedHintAreaEl.innerHTML = '';
        feedbackAreaEl.style.display = 'none';
        feedbackAreaEl.className = 'feedback-area';
        hintBtn.disabled = false;
        checkBtn.disabled = false;
        nextBtn.disabled = true;
        if (rightColumnEl) rightColumnEl.scrollTop = 0; // Scroll right column to top if it exists
    }

    function showHint() {
        if (hintUsed || answerChecked) return;

        const currentQuestion = questions[currentQuestionIndex];
        let hintHTML = '';

        if (currentQuestion.highlightSelectors && currentQuestion.highlightSelectors.length > 0) {
            currentQuestion.highlightSelectors.forEach(selector => {
                const elementToHighlight = questionTextEl.querySelector(selector);
                if (elementToHighlight) {
                    elementToHighlight.classList.add('highlight-question');
                }
            });
        }

        if (currentQuestion.hintKeywords && currentQuestion.hintKeywords.length > 0) {
            hintHTML += `<h5>關鍵字提示</h5><ul>`;
            currentQuestion.hintKeywords.forEach(kw => {
                 hintHTML += `<li><span class="keyword-term">${kw.word}:</span> ${kw.definition}</li>`;
            });
            hintHTML += `</ul>`;
        }

        if (currentQuestion.optionTranslations && currentQuestion.optionTranslations.length > 0 && currentQuestion.options.length === currentQuestion.optionTranslations.length) {
             hintHTML += `<h5>選項翻譯</h5><ul>`;
             currentQuestion.options.forEach((opt, index) => {
                 const letter = String.fromCharCode(65 + index);
                 hintHTML += `<li><span class="option-letter">(${letter})</span> ${opt}: ${currentQuestion.optionTranslations[index]}</li>`;
             });
             hintHTML += `</ul>`;
        }

        if (hintHTML !== '') {
             detailedHintAreaEl.innerHTML = hintHTML;
             detailedHintAreaEl.style.display = 'block';
             if (rightColumnEl) rightColumnEl.scrollTop = 0;
        }

        hintUsed = true;
        hintBtn.disabled = true;
    }

    function checkAnswer() {
        const selectedOption = optionsAreaEl.querySelector(`input[name="q${currentQuestionIndex}_options"]:checked`);

        if (!selectedOption) {
            alert('請選擇一個答案！');
            return;
        }

        answerChecked = true;
        const userAnswer = selectedOption.value;
        const currentQuestion = questions[currentQuestionIndex];
        const correctAnswer = currentQuestion.answer;

        optionsAreaEl.querySelectorAll('input[type="radio"]').forEach(input => input.disabled = true);
        optionsAreaEl.querySelectorAll('.option').forEach(div => div.style.cursor = 'default');
        checkBtn.disabled = true;
        hintBtn.disabled = true;

        feedbackExplanationEl.innerHTML = currentQuestion.explanation;
        feedbackAreaEl.style.display = 'block';
        feedbackAreaEl.className = 'feedback-area'; // Reset class first

        if (userAnswer === correctAnswer) {
            score++;
            feedbackTitleEl.textContent = `✅ 正確！`;
            feedbackAreaEl.classList.add('correct');
        } else {
             let correctOptionText = '';
             const correctOptionIndex = currentQuestion.answer.charCodeAt(0) - 65;
             if (correctOptionIndex >= 0 && correctOptionIndex < currentQuestion.options.length) {
                 correctOptionText = currentQuestion.options[correctOptionIndex];
             }
             feedbackTitleEl.textContent = `❌ 錯誤！正確答案是 (${correctAnswer}) ${correctOptionText}`;
             feedbackAreaEl.classList.add('incorrect');
        }

        scoreAreaEl.textContent = `分數: ${score} / ${questions.length}`;
        nextBtn.disabled = false;
        if (rightColumnEl) rightColumnEl.scrollTop = detailedHintAreaEl.offsetHeight + 20;
    }

    function nextQuestion() {
        currentQuestionIndex++;
        if (currentQuestionIndex < questions.length) {
            loadQuestion();
            window.scrollTo(0, 0);
        } else {
            showResults();
        }
    }

    function showResults() {
        quizWrapperEl.style.display = 'none';
        finalScoreEl.textContent = `你的最終分數是: ${score} / ${questions.length}`;
        resultsAreaEl.style.display = 'block';
    }

    hintBtn.addEventListener('click', showHint);
    checkBtn.addEventListener('click', checkAnswer);
    nextBtn.addEventListener('click', nextQuestion);

    loadQuestion();
</script>

</body>
</html>