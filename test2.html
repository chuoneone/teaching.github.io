<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="images/dog.png" type="image/png">
    <title>20ä»¥å…§åŠ æ¸›æ³•ç·´ç¿’æ¸¬é©—</title>
    <style>
        body {
            background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
            font-family: 'Courier New', Courier, monospace;
            color: #fff;
            text-align: center;
            margin: 0;
            padding: 20px;
            font-size: 2rem;
        }

        h1 {
            font-size: 2rem;
        }

        .multiples {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

            .multiples button {
                background-color: #111;
                border: 2px solid #0ff;
                color: #0ff;
                padding: 20px;
                font-size: 1.5rem;
                cursor: pointer;
                width: 120px;
                height: 80px;
                border-radius: 10px;
                transition: all 0.3s;
            }

                .multiples button.selected {
                    background-color: #0ff;
                    color: #111;
                }

        #questionArea, #resultArea, #retryArea {
            display: none;
            margin-top: 20px;
        }

        #progressBar {
            width: 80%;
            height: 20px;
            background-color: #444;
            border-radius: 10px;
            margin: 20px auto;
            overflow: hidden;
        }

        #progressBarInner {
            height: 100%;
            width: 0%;
            background-color: #0ff;
            transition: width 0.3s;
        }

        footer {
            margin-top: 50px;
            font-size: 0.9rem;
            color: #aaa;
        }

        input[type="number"] {
            font-size: 1.5rem;
            padding: 5px;
            width: 100px;
            text-align: center;
        }

        button.action {
            padding: 10px 20px;
            font-size: 1.2rem;
            background-color: #0ff;
            color: #000;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
        }

        #feedback {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 20px 0;
            font-size: 2rem;
        }

        #wrongList {
            margin-top: 20px;
            font-size: 1.3rem;
            color: #ff8080;
        }
    </style>
</head>
<body>
    <h1>20ä»¥å…§åŠ æ¸›æ³•ç·´ç¿’æ¸¬é©—</h1>
    <div id="selectionArea">
        <p>è«‹é¸æ“‡è¦ç·´ç¿’çš„é¡Œå‹ï¼š</p>
        <div class="multiples">
            <button data-type="add">åŠ æ³•</button>
            <button data-type="sub">æ¸›æ³•</button>
        </div>
        <button class="action" id="startTest">é–‹å§‹æ¸¬é©—</button>
    </div>

    <div id="questionArea">
        <div id="progressBar"><div id="progressBarInner"></div></div>
        <h2 id="questionText"></h2>
        <input type="number" id="answerInput" autofocus>
        <p id="feedback"></p>
        <button class="action" id="nextBtn">ä¸‹ä¸€é¡Œ</button>
    </div>

    <div id="resultArea">
        <h2>æ¸¬é©—å®Œæˆï¼</h2>
        <p id="scoreText"></p>
        <div id="wrongList"></div>
        <button class="action" id="retryWrong">éŒ¯é¡Œé‡æ¸¬</button>
        <button class="action" id="restart">é‡æ–°æ¸¬é©—</button>
    </div>

    <footer>
        <img src="images/dog.png" alt="Logo" style="height: 100px; vertical-align: middle; margin-right: 10px;">
        <br>
        <p style="display: inline;">Created by Chu Pei Yi</p>
    </footer>

    <script>
        const buttons = document.querySelectorAll('.multiples button');
        const startBtn = document.getElementById('startTest');
        const questionArea = document.getElementById('questionArea');
        const selectionArea = document.getElementById('selectionArea');
        const questionText = document.getElementById('questionText');
        const answerInput = document.getElementById('answerInput');
        const feedback = document.getElementById('feedback');
        const nextBtn = document.getElementById('nextBtn');
        const progressBarInner = document.getElementById('progressBarInner');
        const resultArea = document.getElementById('resultArea');
        const scoreText = document.getElementById('scoreText');
        const retryWrongBtn = document.getElementById('retryWrong');
        const restartBtn = document.getElementById('restart');
        const wrongList = document.getElementById('wrongList');

        let selectedTypes = [];
        let questions = [];
        let currentQuestion = 0;
        let correctCount = 0;
        let wrongAnswers = [];
        let answerChecked = false;

        buttons.forEach(btn => {
            btn.addEventListener('click', () => {
                btn.classList.toggle('selected');
            });
        });

        startBtn.addEventListener('click', () => {
            selectedTypes = [...document.querySelectorAll('.multiples button.selected')].map(btn => btn.dataset.type);
            if (selectedTypes.length === 0) return alert('è«‹é¸æ“‡è‡³å°‘ä¸€ç¨®é¡Œå‹ã€‚');
            generateQuestions();
            selectionArea.style.display = 'none';
            questionArea.style.display = 'block';
            showQuestion();
        });

        function generateQuestions(fromWrong = false) {
            questions = [];
            if (fromWrong) {
                questions = [...wrongAnswers];
            } else {
                for (let i = 0; i < 10; i++) {
                    let type = selectedTypes[Math.floor(Math.random() * selectedTypes.length)];
                    let a = Math.floor(Math.random() * 21);
                    let b = Math.floor(Math.random() * 21);

                    if (type === 'sub' && a < b) [a, b] = [b, a];
                    questions.push({ a, b, type });
                }
            }
            currentQuestion = 0;
            correctCount = 0;
            wrongAnswers = [];
            answerChecked = false;
        }

        function showQuestion() {
            let q = questions[currentQuestion];
            let op = q.type === 'add' ? '+' : '-';
            questionText.textContent = `ç¬¬ ${currentQuestion + 1} é¡Œï¼š${q.a} ${op} ${q.b} = ?`;
            answerInput.value = '';
            feedback.textContent = '';
            answerInput.focus();
            progressBarInner.style.width = `${((currentQuestion) / questions.length) * 100}%`;
            answerChecked = false;
        }

        function checkAnswer() {
            if (answerChecked) return;
            let userAns = parseInt(answerInput.value);
            let q = questions[currentQuestion];
            let correct = q.type === 'add' ? q.a + q.b : q.a - q.b;
            if (userAns === correct) {
                feedback.textContent = 'ğŸ‰ å¤ªæ£’äº†ï¼ç­”å°äº†ï¼';
                correctCount++;
            } else {
                feedback.textContent = `ğŸ˜¢ æ²’é—œä¿‚å†åŠ æ²¹å§ï¼æ­£ç¢ºç­”æ¡ˆæ˜¯ ${correct}`;
                wrongAnswers.push(q);
            }
            answerChecked = true;
        }

        function nextQuestion() {
            if (!answerChecked) {
                checkAnswer();
                return;
            }
            currentQuestion++;
            if (currentQuestion < questions.length) {
                showQuestion();
            } else {
                showResult();
            }
        }

        answerInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') nextQuestion();
        });

        nextBtn.addEventListener('click', nextQuestion);

        function showResult() {
            questionArea.style.display = 'none';
            resultArea.style.display = 'block';
            let score = correctCount * 10;
            scoreText.textContent = `ä½ çš„æˆç¸¾æ˜¯ ${score} åˆ†ã€‚${score >= 90 ? 'å¤ªæ£’äº†ï¼ç¹¼çºŒä¿æŒï¼ğŸ’ª' : ''}`;

            if (wrongAnswers.length > 0) {
                wrongList.innerHTML = '<h3>éŒ¯é¡Œåˆ—è¡¨ï¼š</h3><ul>' + wrongAnswers.map(q => {
                    let op = q.type === 'add' ? '+' : '-';
                    let ans = q.type === 'add' ? q.a + q.b : q.a - q.b;
                    return `<li>${q.a} ${op} ${q.b} = ${ans}</li>`;
                }).join('') + '</ul>';
            } else {
                wrongList.innerHTML = '<p>ğŸ‰ ä½ æ²’æœ‰éŒ¯é¡Œå–”ï¼å¤ªå²å®³äº†ï¼</p>';
            }
        }

        retryWrongBtn.addEventListener('click', () => {
            if (wrongAnswers.length === 0) return alert('æ²’æœ‰éŒ¯é¡Œå¯é‡æ¸¬ã€‚');
            generateQuestions(true);
            resultArea.style.display = 'none';
            questionArea.style.display = 'block';
            showQuestion();
        });

        restartBtn.addEventListener('click', () => {
            document.querySelectorAll('.multiples button').forEach(btn => btn.classList.remove('selected'));
            resultArea.style.display = 'none';
            selectionArea.style.display = 'block';
        });
    </script>
</body>
</html>
